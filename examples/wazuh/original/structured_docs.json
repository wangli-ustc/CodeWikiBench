{
  "title": "wazuh",
  "description": "Documentation for wazuh",
  "content": {},
  "metadata": {
    "type": "root",
    "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs"
  },
  "subpages": [
    {
      "title": "Readme",
      "description": null,
      "content": {
        "Introduction ": "In an attempt to explain the functioning and responsibilities of each component of the **Wazuh Manager**, the following documentation provides a comprehensive overview of main modules within the project. "
      },
      "metadata": {},
      "subpages": [],
      "path": "[\"subpages\", 0]"
    },
    {
      "title": "Summary",
      "description": null,
      "content": {
        "Summary": [
          "[Introduction](README.md)"
        ],
        "Development Documentation": "",
        "Reference Manual": [
          "[Introduction](ref/README.md)",
          [
            "[Description](ref/description.md)",
            "[Architecture](ref/architecture.md)",
            "[Compatibility](ref/compatibility.md)"
          ],
          "[Getting Started](ref/getting-started/README.md)",
          [
            "[Requirements](ref/getting-started/requirements.md)",
            "[Packages](ref/getting-started/packages.md)",
            "[Installation](ref/getting-started/installation.md)"
          ],
          "[Configuration](ref/configuration.md)",
          "[Modules](ref/modules/README.md)",
          [
            "[Engine](ref/modules/engine/README.md)",
            [
              "[Architecture](ref/modules/engine/architecture.md)",
              "[API Reference](ref/modules/engine/api-reference.md)",
              "[Outputs Reference](ref/modules/engine/ref-output.md)",
              "[Parsers Reference](ref/modules/engine/ref-parser.md)",
              "[Helper Functions Reference](ref/modules/engine/ref-helper-functions.md)",
              "[Dev internal tools](ref/modules/engine/internal-tools.md)"
            ],
            "[InventoryHarvester](ref/modules/inventory-harvester/README.md)",
            [
              "[Architecture](ref/modules/inventory-harvester/architecture.md)",
              "[API Reference](ref/modules/inventory-harvester/api-reference.md)",
              "[Configuration](ref/modules/inventory-harvester/configuration.md)",
              "[Description](ref/modules/inventory-harvester/description.md)"
            ],
            "[VulnerabilityScanner](ref/modules/vulnerability-scanner/README.md)",
            [
              "[Architecture](ref/modules/vulnerability-scanner/architecture.md)",
              "[API Reference](ref/modules/vulnerability-scanner/api-reference.md)",
              "[Configuration](ref/modules/vulnerability-scanner/configuration.md)",
              "[Schemas](ref/modules/vulnerability-scanner/flatbuffers.md)",
              "[Test Tools](ref/modules/vulnerability-scanner/test-tools.md)",
              "[Events description](ref/modules/vulnerability-scanner/events.md)"
            ],
            "[Flatbuffers](ref/modules/utils/flatbuffers/README.md)"
          ],
          "[Upgrade](ref/upgrade.md)",
          "[Uninstall](ref/uninstall.md)",
          "[Back Up and Restore](ref/backup-restore.md)",
          "[Security](ref/security.md)",
          "[Performance](ref/performance.md)",
          "[Glossary](ref/glossary.md)"
        ],
        "Diagnostic Documentation": ""
      },
      "metadata": {},
      "subpages": [],
      "path": "[\"subpages\", 1]"
    },
    {
      "title": "Ref",
      "description": "Documentation section: ref",
      "content": {},
      "metadata": {
        "type": "directory",
        "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref"
      },
      "subpages": [
        {
          "title": "Readme",
          "description": null,
          "content": {
            "Introduction": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 0]"
        },
        {
          "title": "Architecture",
          "description": null,
          "content": {
            "Architecture": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 1]"
        },
        {
          "title": "Backup Restore",
          "description": null,
          "content": {
            "Back Up and Restore": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 2]"
        },
        {
          "title": "Compatibility",
          "description": null,
          "content": {
            "Compatibility": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 3]"
        },
        {
          "title": "Configuration",
          "description": null,
          "content": {
            "Configuration": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 4]"
        },
        {
          "title": "Description",
          "description": null,
          "content": {
            "Description": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 5]"
        },
        {
          "title": "Glossary",
          "description": null,
          "content": {
            "Glossary": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 6]"
        },
        {
          "title": "Performance",
          "description": null,
          "content": {
            "Performance": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 7]"
        },
        {
          "title": "Security",
          "description": null,
          "content": {
            "Security": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 8]"
        },
        {
          "title": "Uninstall",
          "description": null,
          "content": {
            "Uninstall": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 9]"
        },
        {
          "title": "Upgrade",
          "description": null,
          "content": {
            "Upgrade": ""
          },
          "metadata": {},
          "subpages": [],
          "path": "[\"subpages\", 2, \"subpages\", 10]"
        },
        {
          "title": "Getting Started",
          "description": "Documentation section: getting-started",
          "content": {},
          "metadata": {
            "type": "directory",
            "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/getting-started"
          },
          "subpages": [
            {
              "title": "Readme",
              "description": null,
              "content": {
                "Getting Started": ""
              },
              "metadata": {},
              "subpages": [],
              "path": "[\"subpages\", 2, \"subpages\", 11, \"subpages\", 0]"
            },
            {
              "title": "Installation",
              "description": null,
              "content": {
                "Installation": ""
              },
              "metadata": {},
              "subpages": [],
              "path": "[\"subpages\", 2, \"subpages\", 11, \"subpages\", 1]"
            },
            {
              "title": "Packages",
              "description": null,
              "content": {
                "Packages": ""
              },
              "metadata": {},
              "subpages": [],
              "path": "[\"subpages\", 2, \"subpages\", 11, \"subpages\", 2]"
            },
            {
              "title": "Requirements",
              "description": null,
              "content": {
                "Requirements": ""
              },
              "metadata": {},
              "subpages": [],
              "path": "[\"subpages\", 2, \"subpages\", 11, \"subpages\", 3]"
            }
          ],
          "path": "[\"subpages\", 2, \"subpages\", 11]"
        },
        {
          "title": "Modules",
          "description": "Documentation section: modules",
          "content": {},
          "metadata": {
            "type": "directory",
            "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/modules"
          },
          "subpages": [
            {
              "title": "Readme",
              "description": null,
              "content": {
                "Modules": [
                  "[Inventory Harvester](inventory-harvester/)",
                  "[Vulnerability Scanner](vulnerability-scanner/)",
                  "[Flatbuffers](utils/flatbuffers/)"
                ]
              },
              "metadata": {},
              "subpages": [],
              "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 0]"
            },
            {
              "title": "Engine",
              "description": "Documentation section: engine",
              "content": {},
              "metadata": {
                "type": "directory",
                "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/modules/engine"
              },
              "subpages": [
                {
                  "title": "Engine",
                  "description": null,
                  "content": {
                    "Introduction": "The engine is responsible for transforming raw data into standardized schema documents, enriching it with threat intelligence, and forwarding it to designated destinations.",
                    "Data flow": {
                      "Event": "The purpose of the Engine is to convert unstructured or semi-structured logs into normalized and enriched events. The agent transmits logs within a JSON payload, which includes additional metadata such as OS information, log source, and other relevant details. The Engine processes these logs and generates a structured JSON event, incorporating all relevant information in accordance with the defined [schema](#).\n\nInput event example:\n\n```\n{\n  \"@timestamp\": \"2025-01-23T17:40:37Z\",\n  \"agent\": {\n    \"groups\": [\n      \"group1\",\n      \"group2\"\n    ],\n    \"host\": {\n      \"architecture\": \"x86_64\",\n      \"hostname\": \"wazuh-endpoint-linux\",\n      \"ip\": [\n        \"192.168.1.2\"\n      ],\n      \"os\": {\n        \"name\": \"Amazon Linux 2\",\n        \"platform\": \"Linux\"\n      }\n    },\n    \"id\": \"2887e1cf-9bf2-431a-b066-a46860080f56\",\n    \"name\": \"wazuh-agent-name\",\n    \"type\": \"endpoint\",\n    \"version\": \"5.0.0\"\n  },\n  \"event\": {\n    \"collector\": \"file\",\n    \"module\": \"logcollector\",\n    \"original\": \"Dec 13 11:35:28 a-mac-with-esc-key GoogleSoftwareUpdateAgent[21412]: 2016-12-13 11:35:28.421 GoogleSoftwareUpdateAgent[21412/0x700007399000] [lvl=2] -[KSUpdateEngine updateAllExceptProduct:] KSUpdateEngine updating all installed products, except:'com.google.Keystone'.\"\n  },\n  \"log\": {\n    \"file\": {\n      \"path\": \"/var/log/syslog.log\"\n    }\n  },\n}\n```\n\nProcessed event:\n\n```\n{\n  \"@timestamp\": \"2025-01-23T17:40:37Z\",\n  \"agent\": {\n    \"groups\": [\n      \"group1\",\n      \"group2\"\n    ],\n    \"host\": {\n      \"architecture\": \"x86_64\",\n      \"hostname\": \"wazuh-endpoint-linux\",\n      \"ip\": [\n        \"192.168.1.2\"\n      ],\n      \"os\": {\n        \"name\": \"Amazon Linux 2\",\n        \"platform\": \"Linux\"\n      }\n    },\n    \"id\": \"2887e1cf-9bf2-431a-b066-a46860080f56\",\n    \"name\": \"wazuh-agent-name\",\n    \"type\": \"endpoint\",\n    \"version\": \"5.0.0\"\n  },\n  \"event\": {\n    \"collector\": \"file\",\n    \"created\": \"2024-11-22T02:00:00Z\",\n    \"kind\": \"event\",\n    \"module\": \"logcollector\",\n    \"original\": \"Dec 13 11:35:28 a-mac-with-esc-key GoogleSoftwareUpdateAgent[21412]: 2016-12-13 11:35:28.421 GoogleSoftwareUpdateAgent[21412/0x700007399000] [lvl=2] -[KSUpdateEngine updateAllExceptProduct:] KSUpdateEngine updating all installed products, except:'com.google.Keystone'.\",\n    \"start\": \"2025-12-13T11:35:28.000Z\"\n  },\n  \"host\": {\n    \"hostname\": \"a-mac-with-esc-key\"\n  },\n  \"log\": {\n    \"file\": {\n      \"path\": \"/var/log/syslog.log\"\n    }\n  },\n  \"message\": \"2016-12-13 11:35:28.421 GoogleSoftwareUpdateAgent[21412/0x700007399000] [lvl=2] -[KSUpdateEngine updateAllExceptProduct:] KSUpdateEngine updating all installed products, except:'com.google.Keystone'.\",\n  \"process\": {\n    \"name\": \"GoogleSoftwareUpdateAgent\",\n    \"pid\": 21412\n  },\n  \"related\": {\n    \"hosts\": [\n      \"a-mac-with-esc-key\"\n    ]\n  },\n  \"tags\": [\n    \"production-server\"\n  ],\n  \"wazuh\": {\n    \"decoders\": [\n      \"syslog\"\n    ]\n  }\n}\n```",
                      "Policy processing": "The policy is the operational graph applied to each event, structured into decoders, rules, and outputs, each related to normalizing, enriching, and delivery respectively.\n\n```\n---\ntitle: Security policy dataflow\n---\nflowchart LR\n\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\nclassDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n\n subgraph decoTree[\"Decoders\"]\n  direction TB\n\n  deco01(\" \")\n  deco02(\" \")\n  deco03(\" \")\n  deco04(\" \")\n  deco05(\" \")\n  deco06(\" \")\n  deco07(\" \")\n  deco08(\" \")\n\n  deco01 --> deco02 & deco03 & deco04\n  deco02 --> deco05\n  deco03 --> deco06 & deco07\n  deco04 --> deco08\n end\n\n subgraph ruleTree[\"Rules\"]\n  direction TB\n\n  rule01(\" \")\n  rule02(\" \")\n  rule03(\" \")\n  rule04(\" \")\n  rule05(\" \")\n  rule06(\" \")\n  rule07(\" \")\n  rule08(\" \")\n\n  rule01 --> rule02 & rule03 & rule04\n  rule02 --> rule05\n  rule03 --> rule06 & rule07\n  rule04 --> rule08\n end\n\n subgraph outputTree[\"Outputs\"]\n  direction TB\n\n  output01(\" \")\n  output02(\" \")\n  output03(\" \")\n  output04(\" \")\n  output05(\" \")\n  output06(\" \")\n  output07(\" \")\n  output08(\" \")\n\n  output01 --> output02 & output03 & output04\n  output02 --> output05\n  output03 --> output06 & output07\n  output04 --> output08\n\n end\n\n decoTree:::TreeBoxClass\n ruleTree:::TreeBoxClass\n outputTree:::TreeBoxClass\n eventInput:::EventBoxClass\n eventOutput:::EventBoxClass\n\n %% Pipeline\n eventInput@{shape: doc, label: \"Event</br>Input\"}==>decoTree==>ruleTree==>outputTree==>eventOutput@{shape: doc, label: \"Enriched</br>Event\"}\n\n```\n\nWazuh comes with a predefined policy that enables all its components to work properly and it is structured on top of Wazuh-supported log sources.\n\nEach source does have a particular way to format and send logs to the engine. The default policy takes care of that, allowing the users to focus on their integrations and not on the nuances of the logs transports for each source.\n\n```\ngraph LR;\n    subgraph Endpoint\n        Service[\"Service\"]\n        WazuhAgent[\"Wazuh agent\"]\n        Service --- WazuhAgent\n    end\n\n    WazuhAgent -.-> Orchestrator[\"Orchestrator: Router\"]\n\n    subgraph WazuhServer[\"Wazuh server\"]\n\n        subgraph Engine\n            Orchestrator --> Route[\"Route\"]\n            Route --> Decoding[\"Decoding Stage\"]\n            subgraph SecurityPolicy[\"Security Policy\"]\n                Decoding --> Rule[\"Rule Stage\"]\n                Rule --> OutputStage[\"Output Stage\"]\n            end\n        end\n    end\n```",
                      "Decoding process": "The decoding process converts unstructured data received by the engine into schema-based JSON events.\n\nAll events enter the pipeline through the root decoder, which determines the appropriate decoder for processing. Each subsequent decoder processes the event as much as possible before passing it to the next suitable decoder. This continues until no further processing can be performed.\n\nA closer examination of the predefined decoders reveals the following structure:\n\n```\n---\ntitle: Decoder tree\n---\nflowchart TD\n\n%% Style\nclassDef AssetSuccessClass fill:#2196f3,stroke-width:2px,fill-opacity:0.8\nclassDef AssetFailClass fill:#f50057,stroke-width:2px,fill-opacity:0.8\nclassDef AssetNotExecutedClass fill:#90a4ae,stroke-width:2px,fill-opacity:0.8\n\n\n%% First Level\ndecoderR(\"root decoder\"):::AssetSuccessClass\ndecoderR --x decoder1\ndecoderR --> decoder2 --> decoder21\ndecoderR -.-> decoder3 -.-> decoder31\n\ndecoder1(\"decoder 1\"):::AssetFailClass\ndecoder2(\"decoder 2\"):::AssetSuccessClass\n\ndecoder1 -.-> decoder11 & decoder12\ndecoder2 -.-> decoder22\n\ndecoder11(\"decoder 1-1\"):::AssetNotExecutedClass\ndecoder12(\"decoder 1-2\"):::AssetNotExecutedClass\ndecoder21(\"decoder 2-1\"):::AssetSuccessClass\ndecoder22(\"decoder 2-2\"):::AssetNotExecutedClass\ndecoder3(\"decoder 3\"):::AssetNotExecutedClass\ndecoder31(\"decoder 3-1\"):::AssetNotExecutedClass\nlinkStyle 0 stroke:#f50057,stroke-width:2px\n\n\n\n```\n\nThe event is evaluated by a decoder to determine if it matches the conditions defined within the decoder. If the decoder rejects the event, it is passed to the next sibling decoder within the same hierarchy for evaluation. This process continues until a decoder accepts the event or no more sibling decoders are available.\n\nWhen a decoder accepts an event, it may modify the event by normalizing or enriching its data. After this, the event is passed to the child decoders of the accepted decoder for further processing. Each child decoder evaluates the event using the same logic, ensuring a hierarchical and iterative approach to event processing.\n\nThis hierarchical evaluation ensures that events are processed efficiently and routed through the appropriate decoders based on their structure and content.\n\nThe following diagram illustrates the event flow on the decoder tree of default policy:\n\n```\n---\ntitle: Event flow on decoder tree\n---\nflowchart LR\n\n classDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\n classDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n\n subgraph decoTree[\"First layer - Internal decoders\"]\n    direction TB\n    deco01(\" \")\n    deco02(\" \")\n    deco03(\" \")\n    deco04(\"Integration Decoder\")\n    deco05(\" \")\n    deco06(\" \")\n    deco07(\" \")\n\n    deco01 --> deco02 & deco03 & deco04\n    deco02 --> deco05\n    deco03 --> deco06 & deco07\n  end\n\n  deco04 -..-> decoIntegration[\"Integration Decoder\"]:::TreeBoxClass\n  eventInput@{shape: doc, label: \"Event</br>Input\"} ==> decoTree\n  decoTree:::TreeBoxClass\n\n subgraph userDecoTree[\"Integrations & User decoders\"]\n    direction TB\n    userDeco01(\" \")\n    userDeco02(\" \")\n    userDeco03(\" \")\n    userDeco04(\" \")\n    userDeco05(\" \")\n    userDeco06(\" \")\n    userDeco07(\" \")\n    userDeco08(\" \")\n\n    userDeco01 --> userDeco02 & userDeco03 & userDeco04\n    userDeco02 --> userDeco05\n    userDeco03 --> userDeco06 & userDeco07\n    userDeco04 --> userDeco08\n  end\n\n\n\n%% decoIntegration --> userDecoTree\ndecoIntegration --> userDeco01\nuserDecoTree ----> eventOutput@{shape: doc, label: \"Normalized</br>event\"}\n\nuserDecoTree:::TreeBoxClass\neventInput:::EventBoxClass\neventOutput:::EventBoxClass\n```\n\nIn the default policy, the first layer is for internal decoders, which are responsible for normalizing events.\nThe second layer is for integrations and user-defined decoders, which are used to process events from specific\nsources or applications.",
                      "Security enrichment process": "The analysis process evaluates all event fields to identify potential security concerns, which are represented as threat\nindicators within the common schema. These indicators are later stored in the Wazuh Indexer, where they can be used for\nthreat hunting and detecting security issues.\n\nAll decoded events pass through the analysis pipeline, starting with the root rule. The root rule determines the next\nappropriate rule for processing the event. If a rule matches, it triggers all its child rules for evaluation in a\nbroadcast manner. Each child rule is independently evaluated, contributing additional threat indicators to the event's\nanalysis. If a rule does not match, its child rules are not evaluated, ensuring efficient processing.\n\nThis hierarchical and broadcast-based evaluation allows the analysis pipeline to enrich events with relevant security\ncontext while maintaining performance and scalability.\n\n```\n---\ntitle: Rules tree\n---\nflowchart TD\n\n%% Style\n  classDef AssetSuccessClass fill:#2196f3,stroke-width:2px,fill-opacity:0.8\n  classDef AssetFailClass fill:#f50057,stroke-width:2px,fill-opacity:0.8\n  classDef AssetNotExecutedClass fill:#90a4ae,stroke-width:2px,fill-opacity:0.8\n  ruleR(\"root rule\") --x rule1(\"rule 1\")\n  rule1 -.-> rule11(\"rule 1-1\") & rule12(\"rule 1-2\")\n  ruleR --> rule2(\"rule 2\")\n  rule2 --> rule21(\"rule 2-1\")\n  rule2 --x rule22(\"rule 2-2\")\n  rule2 --> rule23(\"rule 2-3\")\n  ruleR --> rule3(\"rule 3\")\n  rule3 --> rule31(\"rule 3-1\")\n\n  ruleR:::AssetSuccessClass\n  rule1:::AssetFailClass\n  rule11:::AssetNotExecutedClass\n  rule12:::AssetNotExecutedClass\n  rule2:::AssetSuccessClass\n  rule21:::AssetSuccessClass\n  rule22:::AssetFailClass\n  rule23:::AssetSuccessClass\n  rule3:::AssetSuccessClass\n  rule31:::AssetSuccessClass\n  linkStyle 0,5 stroke:#f50057,stroke-width:2px\n\n\n```\n\nThe following diagram illustrates the event flow on the rules tree of the default policy:\n\n```\n---\ntitle: Event flow on rules\n---\nflowchart LR\n\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\nclassDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n\n subgraph wazuhRulesTree[\"Wazuh Rules\"]\n  direction TB\n\n  wazuhRules01(\" \")\n  wazuhRules02(\" \")\n  wazuhRules03(\" \")\n  wazuhRules04(\" \")\n  wazuhRules05(\" \")\n  wazuhRules06(\" \")\n  wazuhRules07(\" \")\n  wazuhRules08(\" \")\n\n  wazuhRules01 --> wazuhRules02 & wazuhRules03 & wazuhRules04\n  wazuhRules02 --> wazuhRules05\n  wazuhRules03 --> wazuhRules06 & wazuhRules07\n  wazuhRules04 --> wazuhRules08\n end\n\n subgraph userRulesTree[\"User rules\"]\n  direction TB\n\n  userRules01(\" \")\n  userRules02(\" \")\n  userRules03(\" \")\n  userRules04(\" \")\n  userRules05(\" \")\n  userRules06(\" \")\n  userRules07(\" \")\n  userRules08(\" \")\n\n  userRules01 --> userRules02 & userRules03 & userRules04\n  userRules02 --> userRules05\n  userRules03 --> userRules06 & userRules07\n  userRules04 --> userRules08\n\n end\n\n wazuhRulesTree:::TreeBoxClass\n userRulesTree:::TreeBoxClass\n eventInput:::EventBoxClass\n eventOutput:::EventBoxClass\n\n %% Pipeline\n eventInput@{shape: doc, label: \"Normalized</br>Event\"}==>wazuhRulesTree & userRulesTree-.->eventOutput@{shape: doc, label: \"Security</br>event\"}\n\n```\n\nThe analysis pipeline is divided into two layers:\n\n['**Wazuh Rules**: Contains the default rules provided by Wazuh.', '**User Rules**: Contains user-defined rules.']\n\nThen both the Wazuh and user rules are applied to the event.",
                      "Archiving and alerting process": "Once an event has completed processing through the decoder and rule pipelines, it enters the output pipeline.\nSimilar to previous stages, the event first passes through the root output, which determines the appropriate output(s)\nfor further processing. Multiple outputs can be selected, enabling flexible storage and distribution policies.\n\nThe output process in Wazuh is designed to efficiently distribute alerts through broadcasting, with each output capable\nof filtering alerts to support customized distribution:\n\n```\n---\ntitle: Event flow on outputs\n---\nflowchart TD\n\n    outputR --> output1(\"Indexer alert output\") & output2(\"File alerts output\")\n    outputR(\"Broadcaster output\") --x output3(\"File archive output\")\n    outputR(\"Broadcaster output\") --x output4(\"Other output\")\n\n     outputR:::AssetSuccessClass\n     output1:::AssetSuccessClass\n     output2:::AssetSuccessClass\n     output3:::AssetFailClass\n     output4:::AssetSuccessClass\n    classDef AssetSuccessClass fill:#3f51b5,stroke-width:2px,fill-opacity:0.5\n    classDef AssetFailClass fill:#f44336,stroke-width:2px,fill-opacity:0.5\n    classDef AssetNotExecutedClass fill:#9e9e9e,stroke-width:2px,fill-opacity:0.5\n    linkStyle 2 stroke:#D50000,fill:none\n```",
                      "Full pipeline": "The following diagram illustrates the full pipeline of the default policy, including the decoding, rule, and output\nstages:\n\n```\nflowchart TD\n\n classDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\n classDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n classDef ModuleArchClass fill:#673ab7,stroke-width:2px,fill-opacity:0.5, font-size: 20px\n classDef SubModuleArchClass fill:#673ab7,stroke-width:2px,fill-opacity:0.5, font-size: 15px\n\n%% --------------------------------------\n%%           Decoding Stage\n%% --------------------------------------\n\n subgraph decoTree[\"First layer - Internal decoders\"]\n    direction TB\n    decoInputRoot(\" \")\n    deco02(\" \")\n    deco03(\" \")\n    integrationDecoder(\"Integration Decoder\")\n    deco05(\" \")\n    deco06(\" \")\n    deco07(\" \")\n\n    decoInputRoot --> deco02 & deco03 & integrationDecoder\n    deco02 --> deco05\n    deco03 --> deco06 & deco07\n  end\n\n  integrationDecoder -..-> userDecoRoot:::TreeBoxClass\n\n\n subgraph userDecoTree[\"Integrations & User decoders\"]\n    direction TB\n    userDecoRoot(\" \")\n    userDeco02(\" \")\n    userDeco03(\" \")\n    userDeco04(\" \")\n    userDeco05(\" \")\n    userDeco06(\" \")\n    userDeco07(\" \")\n    userDeco08(\" \")\n\n    userDecoRoot --> userDeco02 & userDeco03 & userDeco04\n    userDeco02 --> userDeco05\n    userDeco03 --> userDeco06 & userDeco07\n    userDeco04 --> userDeco08\n  end\n\n%% Stage block\nsubgraph decoderStage[\"Decoding Stage\"]\n    decoTree:::TreeBoxClass\n    userDecoTree:::TreeBoxClass\nend\n\n\n\n%% Output decoder stage\neventNormalized@{shape: doc, label: \"Normalized</br>event\"}\neventNormalized:::EventBoxClass\n\n%% Pipieline\nrouteSelector ==> decoInputRoot\nuserDecoTree ====> eventNormalized\n\n%% --------------------------------------\n%%           Rules Stage\n%% --------------------------------------\n\n subgraph wazuhRulesTree[\"Wazuh Rules\"]\n  direction TB\n\n  wazuhRules01(\" \")\n  wazuhRules02(\" \")\n  wazuhRules03(\" \")\n  wazuhRules04(\" \")\n  wazuhRules05(\" \")\n  wazuhRules06(\" \")\n  wazuhRules07(\" \")\n  wazuhRules08(\" \")\n\n  wazuhRules01 --> wazuhRules02 & wazuhRules03 & wazuhRules04\n  wazuhRules02 --> wazuhRules05\n  wazuhRules03 --> wazuhRules06 & wazuhRules07\n  wazuhRules04 --> wazuhRules08\n end\n\n subgraph userRulesTree[\"User rules\"]\n  direction TB\n\n  userRules01(\" \")\n  userRules02(\" \")\n  userRules03(\" \")\n  userRules04(\" \")\n  userRules05(\" \")\n  userRules06(\" \")\n  userRules07(\" \")\n  userRules08(\" \")\n\n  userRules01 --> userRules02 & userRules03 & userRules04\n  userRules02 --> userRules05\n  userRules03 --> userRules06 & userRules07\n  userRules04 --> userRules08\n\n end\n\n\n\nsubgraph ruleStage[\"Rules Stage\"]\n wazuhRulesTree:::TreeBoxClass\n userRulesTree:::TreeBoxClass\nend\n\n%% Output stage rules\nsecurityEvent@{shape: doc, label: \"Security</br>event\"}\nsecurityEvent:::EventBoxClass\n\n%% Pipieline\neventNormalized==>wazuhRulesTree & userRulesTree-.->securityEvent\n\n%% --------------------------------------\n%%           Output Stage\n%% --------------------------------------\n subgraph outputTree[\"Outputs\"]\n  direction TB\n\n  output01(\" \")\n  output02(\" \")\n  output03(\" \")\n  output04(\" \")\n  output05(\" \")\n  output06(\" \")\n  output07(\" \")\n  output08(\" \")\n\n  output01 --> output02 & output03 & output04\n  output02 --> output05\n  output03 --> output06 & output07\n  output04 --> output08\n\n end\n outputTree:::TreeBoxClass\n\n%% Pipieline output\n securityEvent ==> outputTree\n\n\n%% --------------------------------------\n%%           Default Policy\n%% --------------------------------------\nsubgraph defaultPolicy[\"Default policy\"]\n  decoderStage\n  eventNormalized\n  ruleStage\n  securityEvent\n  outputTree\nend\ndefaultPolicy:::SubModuleArchClass\n\n\n%% --------------------------------------\n%%           Engine\n%% --------------------------------------\n%% Input Decodeing Stage\neventInput@{shape: doc, label: \"Incoming event</br>from endpoint\"}\neventInput:::EventBoxClass\n\nsubgraph engine[\"engine\"]\n  defaultPolicy\n  routeSelector([\"Orchestrator: Router (Route selector)\"])\nend\nengine:::ModuleArchClass\n\neventInput ===> routeSelector\n\n```"
                    },
                    "Schema": {
                      "Configuration": "The schema configuration for the engine follows a structured format where each field is defined with specific attributes. The schema consists of a JSON object with the following key elements:\n\n['Fields Definition:', ['The fields object contains a list of field names as keys.', 'Each field has a corresponding object defining its properties.'], 'Field Properties:\\nEach field in the schema contains two primary properties:', ['`type`: Specifies the OpenSearch field type, such as date, keyword, text, integer, etc.', '`array`: A boolean value (true or false) indicating whether the field can store multiple values (i.e., an array) or just a single value.']]\n\n```\n{\n  \"name\": \"schema/engine-schema/0\",\n  \"fields\": {\n    \"@timestamp\": {\n      \"type\": \"date\",\n      \"array\": false\n    },\n    \"agent.build.original\": {\n      \"type\": \"keyword\",\n      \"array\": false\n    },\n    \"agent.ephemeral_id\": {\n      \"type\": \"keyword\",\n      \"array\": false\n    },\n    \"agent.id\": {\n      \"type\": \"keyword\",\n      \"array\": false\n    }\n  }\n}\n```",
                      "Implications": [
                        "Operational Graph and Consistency Enforcement",
                        [
                          "The schema is used during the construction of the operational graph to ensure that all operations are valid based on the defined field types and structures.",
                          "Whenever possible, schema validation is performed at build time to prevent misconfigurations before execution.",
                          "If an operation's consistency cannot be fully validated at build time, additional runtime checks are applied to ensure adherence to the schema."
                        ],
                        "Consistency and Normalization in Dashboards",
                        [
                          "The schema ensures that data displayed in dashboards follows a consistent structure.",
                          "This enables seamless aggregation, filtering, and visualization by maintaining a predictable and normalized data format."
                        ]
                      ]
                    },
                    "Managing the Engine's processing": {
                      "Namespaces": "To organize assets efficiently, the Engine categorizes them into namespaces. Internally, assets are stored directly under a specific namespace, allowing for structured management and role-based segregation of policies.\n\nThe default policy asset namespaces in the Engine are:\n\n['`system` – Core assets responsible for handling internal event processing and ensuring basic event normalization.', '`wazuh` – Default integrations developed and maintained by Wazuh.', '`user` – A default namespace for end-user-defined assets.']\n\nWhile these are the predefined namespaces, the Engine allows creating as many namespaces as needed, enabling flexibility in asset management.",
                      "Assets Catalog": "The Catalog is responsible for managing the Engine’s assets, organizing them under namespaces. Each asset is uniquely identified by its name, following the convention:\n\n```\n<type>/<name>/<version>\n```\n\nThis naming structure ensures clear versioning and categorization of assets. The following asset types are defined:\n\n['**decoders** – Responsible for normalizing events, transforming raw data into a structured format.', '**rules** – Handle security analysis and event enrichment, identifying threats and adding contextual information.', '**outputs** – Define storage policies for processed events, determining how and where data is stored.', '**filters** – Used for event routing, ensuring events are correctly directed to the appropriate policies.', '**integrations** – Serve as manifests for other assets, grouping related assets that support a common goal. Typically used to bundle all assets required for specific services.']\n\nAll API calls to the Catalog support name-path operations, allowing users to manage specific assets or entire groups efficiently. (Refer to the API documentation for a full list of available catalog operations.)",
                      "Policies and Routes": {
                        "Architecture": "The Engine is composed of distinct modules, each responsible for managing a specific aspect of event processing:\n\n['Catalog → Manages assets (decoders, rules, filters, outputs, integrations).', 'Policy → Manages policies, defining how assets are organized and processed.', 'Orchestrator → Manages routes, pairing filters with policies to control event processing.']\n\nAll modules follow the same naming convention, ensuring that every item—whether an asset, policy, or route—can be stored and identified homogeneously by the Store module.\n\nFor more information on the Engine’s architecture and how the modules interact, refer to [architecture documentation](architecture.md)."
                      }
                    },
                    "Assets": {
                      "Attributes": "Attributes are configuration details. Although the order of definition does not matter, we follow the convention of defining them in the order of name, metadata, and parents.\n\n['**Name**: Identifies the asset and follows the pattern `<asset_type>/<name>/<version>`.', '**Metadata**: Contains all information about the asset. The exact subfields depend on the asset type.', '**Parents**: When applicable to the asset, this defines the order in the asset graph. The exact child selection depends on the specific asset graph type.', '**Definitions**: Defines symbols that will be replaced throughout the document in its occurrences.']",
                      "Stages": "The stages define the operation chain and flow the asset performs on events. Each stage is executed in the order of definition:\n\n```\n---\nconfig:\n  nodeSpacing: 30\n  rankSpacing: 25\n  flowchart:\n    subGraphTitleMargin:\n      top: 20\n      bottom: 20\n---\nflowchart TB\n\nclassDef partsAssetsClass font-size:15px,stroke-width:2px,stroke-dasharray:10px,rx:15,ry:15\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\nclassDef stateFailClass fill:#f50057,stroke-width:2px,fill-opacity:0.5\nclassDef stateSuccessClass fill:#2196f3,stroke-width:2px,fill-opacity:0.8\n\neventInput@{ shape: doc, label: \"Event input\"}\neventInput:::EventBoxClass\neventInput ---> stage_1\n\n\nsubgraph stages[\"Stages\"]\n   direction TB\n   stage_1([\"Process stage 1\"])\n   stage_2([\"Process stage 2\"])\n   stage_3([\"Process stage ...\"])\n   stage_4([\"Process stage n\"])\n   stage_1 --->|success| stage_2\n   stage_2 --->|success| stage_3\n   stage_3 --->|success| stage_4\nend\nstages:::partsAssetsClass\n\nfailedState@{ shape: dbl-circ, label: \"Asset fail\" }\nfailedState:::stateFailClass\nstage_1 --->|failed|failedState\nstage_2 --->|failed|failedState\nstage_3 --->|failed|failedState\n\nsuccessState@{ shape: dbl-circ, label: \"Asset success\" }\nsuccessState:::stateSuccessClass\nstage_4 --->|success| successState\n```\n\nWhen a stage is executed, it can either fail or succeed, depending on the logic of the stage and the operations performed. Each stage is sequentially executed only if the previous stage succeeds.\n\nStages:\n\n['**Check/Allow**: Allows conditional operations to be made on the event. Cannot modify the event.', '**Parse**: Parses fields on the event, acting both as a condition and normalization.', '**Map**: Allows mapping and transformation operations on the event.', '**Normalize**: Defines blocks with a combination of check, parse, and map stages.', '**Output**: Allows operations to communicate outside the Engine, typically used to send events outward. Cannot modify the event.']",
                      "Asset types": "The type of asset is an allowed combination of certain stages. The following table outlines the stages available for each type of asset:\n\n| Asset Type | Allowed Stages |\n|-|-|\n|Decoders|check, parse, map, normalize|\n|Rules|check, map, normalize_rule|\n|Outputs|check, output|\n|Filters|allow|\n\nEach asset has a name and metadata, with custom metadata suited to its specific needs. Additionally, each asset can have parents.",
                      "Operations": "Operations are the fundamental units within the operation graph. Each operation can succeed or fail, forming the basis for defining the graph by combining operations based on their execution results.\n\nOperations are always defined as:\n\n```\ntarget_field: operation\n```\n\nWhere the operation can be:\n\n['**Literal Value**: A direct check or map operation depending on the stage it is defined. This can be any of the YAML native values (string, number, boolean, etc.).', '**Reference**: Denoted by $field_name, it performs a direct check or map operation using the referenced value.', '**Helper Function**: Denoted by helper_name(args), it performs a check or map operation depending on the called helper.']\n\nWhen building an asset, the process can fail if there is any operation that contains a:\n\n['**Syntax Error**: Errors in the target_field or operation syntax.', '**Schema Validation Failure**: Errors such as mapping a boolean into a keyword field, which violates the schema validation rules.', '**Semantic Error**: Incorrect usage, such as using a conditional helper in a map stage.\\nThese errors will be notified when trying to upload the asset to the catalog.']",
                      "Execution Graph Summary": "With a basic understanding of a policy and its components, we can look at the global picture of how the operation graph is defined.\nWithin the policy, we have subgraphs, each corresponding to an asset type:\n\n['Decoders', 'Rules', 'Outputs']\n\n<workflow_placeholder>\n\nEvery event traverses each subgraph independently, forming a chain of subgraphs.\n\nEach graph is composed of assets defined by parent relationships. An event moves down in the graph based on the asset's logical output. If an asset operation succeeds, the event is sent to its child assets.\n\nThe traversal of each subgraph follows these rules:\n\n['**Decoders**: If the current decoder asset succeeds, the event is sent to its first child. If it fails, the event is sent to the next sibling of the parent decoder (logical OR between children).', '**Rules**: If the current rule asset succeeds, the event is broadcast to all its child assets.', '**Outputs**: Events are broadcast to all defined output assets.']\n\nAn asset is considered successful if it accepts the event, meaning all conditional stages have succeeded, regardless of the outcome of transformational stages. This ensures that events are processed through the appropriate path based on successful acceptance checks.\n\nA stage succeeds if the logical combination of its operations succeeds. The exact combination logic is determined by the stage itself. This ensures that each stage can apply its own logic to decide whether it has successfully processed an event.\n\n<workflow_placeholder>",
                      "Helper functions": {
                        "Condition Helpers": "When using conditional helpers, the syntax is:\n\n```\ntarget_field: condition_helper(args)\n```\n\nThe helper will always test a condition on *target_field*. If the condition passes, the operation succeeds; otherwise, it fails.",
                        "Mapping Helpers": "When using mapping helpers, the syntax is:\n\n```\ntarget_field: map_helper(args)\n```\n\nThe helper will always map the *target_field* if the operation succeeds. If the operation fails, the *target_field* remains unchanged.",
                        "Transform Helpers": "When using transformational helpers, the syntax is:\n\n```\ntarget_field: transform_helper(args)\n```\n\nThe helper will transform the *target_field* if the operation succeeds. If the operation fails, the *target_field* remains unchanged.\n\nA transformational helper may fail due to implicit conditions, such as expecting a specific type for the target field, missing a reference passed as an argument, etc.\n\n***It is important to understand that every operation can succeed or fail, and this is the foundation for defining the operation graph.***",
                        "Parsing rules": "When using a helper function in a map or check operation:\n\n```\ntarget.field: helper_name(args…)\n```\n\nThe arguments for `helper_name` can be references to other fields, or JSON values (string, number, boolean, array, or object). Multiple arguments should be separated by commas.\n\nWhen the helper function is built, arguments are parsed in the following order:\n\n[\"**Quoted argument**: `'value'` starts and ends with a single quote. `\\\\` and `'` can be escaped.\", '**Reference**: `$reference` starts with `$`, followed by alphanumerics plus `#`, `_`, `@`, and `-`, separated by dots.', '**JSON value**: An attempt is made to parse the argument as JSON (any valid JSON type).', \"**Raw string**: If none of the above apply, the argument is handled as a string value, with escapes allowed for `$`, `'`, `,`, `)`, `\\\\`, and whitespace.\"]\n\nInvalid escape sequences will always fail.\n\nFor example:\n\n```\ntarget.field: helper_name('string', $reference, 123, {\"key\": \"value\"})\n```\n\nThis call applies `helper_name` to the `target.field` with arguments:\n\n[\"`'string'`: A string value.\", '`$reference`: A reference to another field.', '`123`: A numeric value (valid JSON).', '`{\"key\": \"value\"}`: A JSON object.']\n\n['[!NOTE]\\n`123` is a valid json, not only the objects are valid jsons according to the JSON standard,\\nbut also the numbers, strings, booleans and null values are valid JSON values.']\n\nWhen parsing a helper function inside a logical check expression the same rules apply adding that at least one argument\nis expected for the helper, specifying the target field:\n\n```\ncheck: helper_name($target.field, args…)\n```\n\nAdded we can specify comparison helpers as operators:\n\n```\ncheck: $target.field <op> <value>\n```\n\nWhere value is parsed as a single helper argument following the same escaping rules and order.\n\nWhere op is any of the following:\n\n['`==`', '`!=`', '`<`', '`<=`', '`>`', '`>=`']\n\nWhen using any operator that is not the equality operator only string or integer values are allowed.\n\nWhen using the default map or filter functions for string operations, values are parsed according to standard YAML\n(or JSON) types. If a value is a string and begins with the reference symbol `$`, it is treated as a potential\nreference. If the reference is invalid the operation building fails.\n\n```\ncheck:\n  - target.field: <yaml_type>|<$ref>\nmap:\n  - target.field: <yaml_type>|<$ref>\n```\n\nBelow are some usage examples:\n\n```\n# Example 1: Simple equality check\ncheck: http.method == \"GET\"\n\n# Example 2: Comparison with an integer value\ncheck: $event.severity > 3\n\n# Example 3: Using a helper function in check\ncheck: cidr_match($source.ip, \"192.168.0.0\", 24)\n\n```"
                      },
                      "Definitions": {
                        "Restrictions": [
                          "**Naming Conflicts**: Definitions cannot have the same name as a schema field. Doing so will result in a failure to build the asset.",
                          "**Precedence**: Definitions take precedence over custom fields. If a definition exists with the same name as a custom field, all references to the field will be replaced by the definition's value.",
                          "**Chaining Definitions**: Definitions can use other definitions in their values as long as they are defined beforehand.",
                          "**Context**: Definitions can only appear on the right side of operations, meaning we can't define the structure of the document with definitions or be used inside non operational stages.",
                          "**Scope**: Definitions are scoped to the asset where they are defined. They cannot be shared across assets."
                        ],
                        "Use Cases": [
                          "**Parsing Complex Logs**",
                          [
                            "Logs with extensive or structured headers can be broken into reusable definitions for clarity and to avoid redundancy.",
                            "**Example**: Defining reusable components (TYPE_FIELD, MSG_FIELD) for parsing various log formats."
                          ],
                          "**Handling Large Value Lists**",
                          [
                            "When working with extensive arrays (e.g., banned IPs), definitions keep the configuration readable and maintainable.",
                            "**Example**: Using a predefined list of banned IPs to check against source IPs in a normalize stage."
                          ],
                          "**Small Key-Value Databases (kvdbs)**",
                          [
                            "When small mappings are needed but don’t justify a full kvdb, definitions provide a lightweight alternative.",
                            "**Example**: Mapping log levels or event IDs to structured categories, types, and outcomes for normalization."
                          ]
                        ]
                      },
                      "Variables": "Variables are temporary fields scoped to the current asset that is processing an event. They are identified by prefixing their name with an underscore `_`, following the standard field naming convention and supporting any operation just like fields.\n\n```\n_field.name\n```\n\nKey characteristics:\n\n['Scoped to the current asset – Variables exist only within the asset processing the event and do not persist beyond it.', 'Runtime Modifiable – Unlike definitions, which are static, variables can be modified during event processing.']",
                      "Log Parsing": "Log parsing transforms raw log entries into structured data using parser expressions. These expressions serve as an alternative to Grok, eliminating the need for explicit type declarations by leveraging predefined schema-based parsing. Instead of regular expressions, they use specialized parsers for improved accuracy and efficiency.\n\nKey Components:\n\n['Literals: Direct character matches with escape rules for special characters.', 'Fields: Extract structured data, including:', ['Schema fields (predefined in the schema)', 'Custom fields (user-defined, defaulting to text)', 'Optional fields (ignored if missing)', 'Field choices (choosing between multiple fields)'], 'Wildcards: Capture patterns without mapping data to fields.', 'Optional Groups: Make subexpressions optional for flexible parsing.', 'Schema Parsers: Automatically applied when a field of a known type is used, ensuring compatibility with Wazuh Indexer.']\n\nExample:\nThis expression captures an IP or hostname into `client.ip` or `client.address` and, if present, captures a port into `server.port`:\n\n```\nparse|event.original:\n  - \"<client.ip>?<client.address> connected to <server.ip>(?:<server.port>)\"\n```\n\nFor a log entry:\n\n```\n192.168.1.10 connected to 10.0.0.5:443\n```\n\nIt extracts:\n\n```\n{\n  \"client.ip\": \"192.168.1.10\",\n  \"server.ip\": \"10.0.0.5\",\n  \"server.port\": \"443\"\n}\n```\n\nParsers are also available as helper functions for use in map and check operations. For a detailed explanation, see the Parser Stage and Parser Helper Functions sections.",
                      "Key Value Databases": {
                        "Use cases": "**Normalizing Large Serializable Data**: Maps event IDs to predefined categorization fields using a kvdb, simplifying event classification. Example:\n\n```\nnormalize:\n  - map:\n      - event: kvdb_get_merge(windows_security_eventid_to_category_type_action, $event.code)\n```\n\nThis retrieves event categories, types, and actions based on the event ID.\n\n**Checking Indicators of Compromise (IoCs)**: Compares log entries against a kvdb of known malicious IPs to identify potential threats. Example:\n\n```\nnormalize:\n  - check:\n      - source.ip: kvdb_match(known_malicious_ips)\n```\n\nIf a match is found, security-related data is mapped to the event."
                      },
                      "Dates and Timestamps": "Assets are capable of handling dates in various formats and time zones. This flexibility is achieved through configurable\nparsers (refer to the [date parser documentation](ref-parser.html#date-parser) for more details).\n\nOnce a date is parsed, the Engine normalizes it to UTC. This ensures that all timestamps are stored and processed\nhomogeneously, maintaining consistency across event processing and dashboard visualization.",
                      "Geolocation": "Assets are capable of enriching events with geolocation information, enhancing event data with location-based context.\nThis is achieved by using [Maxmind - GeoLite databases](https://www.maxmind.com/), which provide location data based on\nIP addresses. For more details, see the [geo location](ref-helper-functions.md#geoip) helper documentation.\n\nThe GeoLite databases are configured through the API, allowing you to specify the relevant databases to be used for\ngeolocation enrichment. For more information on how to configure these databases, refer to the API documentation.",
                      "Decoders": "Decoders are the first layer of assets that pass through the event when it is processed by a security policy. They are responsible for normalizing the event, transforming it into a structured event.\n\nAll events enter the pipeline through the root decoder, which selects the appropriate decoder to process the event. Each subsequent decoder processes the event as much as it can and then passes it to the next suitable decoder. This continues until no more decoders can process the event. A decoder can only select one next decoder from the available ones.\n\n```\n---\ntitle: Decoder schema\n---\nkanban\n  Decoder[Decoder schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    assetParents[\"parents\"]\n    assetChecks[\"checks\"]\n    decoParsers[\"parser\"]\n    decoNormalize[\"normalize\"]\n```\n\n['**Name**: Identifies the decoder and follows the pattern `<asset_type>/<name>/<version>`. The name is unique and cannot\\nbe repeated. The naming convention for components is `<type>/<name>/<version>`. The component type is `decoder`, and\\nthe version must be 0, since versioning is not implemented:', '**Metadata**: Each decoder has metadata that provides information about the decoder, such as the supported products,\\nversions, and formats. This metadata does not affect the processing stages.\\nThe metadata fields are:', ['`module` (string): The module that the decoder is associated with. I.e., `syslog`, `windows`, `apache`, etc.', '`title` (string): The title of the decoder. I.e., `Windows Event Log Decoder`, `Linux audit system log decoder`, etc.', '`description` (string): A brief description of the decoder.', '`compatibility` (string): A description of the compatibility of the decoder with different products, versions, and formats.\\ni.e `The Apache datasets were tested with Apache 2.4.12 and 2.4.46 and are expected to work with all versions >= 2.2.31 and >= 2.4.16 (independent from operating system)`', '`version` (array): A list of versions for which the logs have been tested and supported. I.e., `2.2.x`, `3.x`, etc.', '`author` (object): The author of the decoder, ie:', '```\\nname: Wazuh, Inc.\\nemail: info@wazuh.com\\nurl: https://wazuh.com\\ndate: 2022-11-15\\n```', '`reference` (array): A list of references to the documentation, i.e.:', '```\\n- https://httpd.apache.org/docs/2.2/logs.html\\n- https://httpd.apache.org/docs/2.4/logs.html\\n```'], '**Parents**: Defines the order in the decoder graph, establishing the parent-child relationship between decoders.\\nA decoder can have multiple parents, when an event is successfully processed in a decoder, it will evaluate the\\nchildren, one by one, until it finds a decoder that successfully processes the event.']\n\n['[!IMPORTANT]\\nThere is no order of priority when evaluating the children, and it cannot be assumed that a sibling decoder will be evaluated before another one.']\n\n['**Checks**: The checks stage is a preliminary stage in the asset processing sequence, designed to assess whether an\\nevent meets specific conditions without modifying the event itself.\\nMore information on the checks stage can be found in the [Check section](#checkallow).']",
                      "Rules": "Rules are the second layer of assets that process events in a security policy. They are responsible for analyzing the\nnormalized event, when the decoding stage is finished, to add context, security indicators, and threat intelligence.\nUnlike decoders,  the rule cannot modify the decoded event, but it can add new certain fields to enrich the event, this\nprevents the rules from being used to decode events.\n\n```\n---\ntitle: Rule schema\n---\nkanban\n  Rule[Rule schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    assetParents[\"parents\"]\n    assetChecks[\"checks\"]\n    ruleNormalize[\"rule_enrichment\"]\n```\n\n['**Name**: Identifies the rule and follows the pattern `<asset_type>/<name>/<version>`. The name is unique and cannot\\nbe repeated. The naming convention for components is `<type>/<name>/<version>`. The component type is `rule`, and\\nthe version must be 0, since versioning is not implemented:', '**Metadata**: Each rule has metadata that provides information about the rule, such as the supported products,\\nversions, and formats. This metadata does not affect the processing stages.\\nThe metadata fields are:', ['`description` (string): A brief description of the rule.', '`TODO: Add more fields when the metadata is defined.`'], '**Parents**: Defines the order in the rule graph, establishing the parent-child relationship between rules, a rule can\\nhave multiple parents, when an event is successfully processed in a rule (rule matches), it will evaluate all the\\nchildren. Unlike decoders, and all children will be evaluated.', '**Checks**: The checks stage is a preliminary stage in the asset processing sequence, designed to assess whether an\\nevent meets specific conditions. On the rules, the checks stage is used to evaluate the conditions that the event must\\nmeet to be considered a security event. More information on the checks stage can be found in the [Check section](#checkallow).', '**Rule Enrichment**: The rule enrichment stage is used to add context, security indicators, and threat intelligence to\\nthe normalized event. This stage is used to add new fields to the event, but it cannot modify the normalized event, it\\nlike the `map` stage, but with the restriction that it cannot modify the normalized event, only rule fields can be added.']",
                      "Outputs": "Outputs are the last layer of assets that process events in a security policy. They are responsible for storing the\nsecurity events in a storage system, sending them to a wazuh-indexer, a file, or sending them to a third-party system.\n\n```\n---\ntitle: Output schema\n---\nkanban\n  Output[Output schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    assetParents[\"parents\"]\n    assetChecks[\"checks\"]\n    OutputNormalize[\"output stage\"]\n```\n\n['**Name**: Identifies the output and follows the pattern `<asset_type>/<name>/<version>`. The name is unique and cannot\\nbe repeated. The naming convention for components is `<type>/<name>/<version>`. The component type is `output`, and\\nthe version must be 0, since versioning is not implemented:', '**Metadata**: Each output has metadata that provides information about the output, such as the destination, version,\\nand format. This metadata does not affect the processing stages.\\nThe metadata fields are:', ['`description`: A brief description of the output.', 'TODO: Add more fields when the metadata is defined.'], '**Parents**: Defines the order in the output graph, establishing the parent-child relationship between outputs.\\nAn output can have multiple parents, when an event is successfully processed in an output, it will evaluate all the\\nchildren. Usually, the outputs are the last assets in the policy, so they do not have children.', '**Checks**: The checks stage is a stage in the output asset used to evaluate the conditions that the event must meet to\\nbe sent to the output. More information on the checks stage can be found in the [Check section](#checkallow).']",
                      "Filters": "The filters are assets with a single stage, the check stage, used to evaluate the conditions without modifying the event.\n\nThe filters are used to:\n\n['Route events to the correct policy in the orchestrator (Most common use case).', 'Filter a event between parent assets and child assets.']\n\n```\n---\ntitle: Filter schema\n---\nkanban\n  Output[Output schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    %% assetParents[\"parents\"]\n    assetChecks[\"allow\"]\n```\n\n['**Name**: Identifies the filter and follows the pattern `<asset_type>/<name>/<version>`. The name is unique and cannot\\nbe repeated. The naming convention for components is `<type>/<name>/<version>`. The component type is `filter`, and\\nthe version must be 0, since versioning is not implemented:', '**Metadata**: Each filter has metadata that provides information about the filter, such as the proposed use case, version,\\nand format. This metadata does not affect the processing stages.\\nThe metadata fields are:', ['`description`: A brief description of the filter.', 'TODO: Add more fields when the metadata is defined.'], '**Allow**: The allow stage is a stage in the filter asset used to evaluate the conditions that the event must meet to\\npass the filter. More information on the checks stage can be found in the [Check/allow section](#checkallow).']\n\n[\"[!NOTE]\\nWhen filter assets are used in the orchestrator, the don't have parents, they are a check stage that is evaluated before\\nthe event is sent to the policy.\"]"
                    },
                    "Stages": {
                      "Check/Allow": {
                        "Condition list": "In a condition list, each condition is described with a pair `property:value`. Here, `property` is the name of any field, and `value` is the condition that the field must meet.\n\nThe event is filtered through all listed conditions, and only events that satisfy all conditions in order are processed further.\n\nDepending on the value, the condition to test is:\n\n['**JSON value**: Tests that the field contains a specific value.', '**Field reference**: Checks that the event contains the field denoted by the reference, and both fields have the same value. A reference is formatted as `$field.name`.', '**Helper function**: Executes a conditional operation on the field, specified by `helper_name(args…)`.']\n\nExample checklist:\n\n```\ncheck:\n  - event.format: text\n  - user.name: $root_user\n  - event.original: exists()\n  - event.id: 1234\n```\n\nAll conditions must be met for the event to pass through the check stage. If any condition fails, the event is not processed further.\n\n['[!NOTE]\\n`event.id: 1234` is not the same as `event.id: \"1234\"` because the first one is a number and the second one is a string.']",
                        "Conditional expression": "For scenarios requiring complex conditions, especially in rules, a conditional expression allows for more nuanced logic. This string uses a subset of first-order logic language, including logical connectives and support for grouping through parentheses.\n\nLogical Connectives:\n\n['Negation (`NOT`)', 'Conjunction (`AND`)', 'Disjunction (`OR`)']\n\nThese connectives facilitate writing conditions between terms where a term can be:\n\n['Value comparison: Formatted as `<$field><op><value>`.', 'Helper function: Expressed as `<helper_name>(<field>, args...)`, except for the “exists” helper, which can be denoted by the field name alone.']\n\nSupported Operators:\n\n['Comparison operators `!=` and `==` are applicable to all data types.', 'Operators `<=`, `<`, `>=`, `>` are supported for numbers and strings (lexicographically).']\n\nExamples of conditional expressions:\n\n```\ncheck: $event.category==\"registry\" AND $event.type==\"change\" AND ($registry.path==\"/some/path\" OR $registry.path==\"/some/other/path\")\n```\n\n```\ncheck: int_less($http.response.status_code, 400)\n```\n\n```\ncheck: $wazuh.origin == /var/log/apache2/access.log OR $wazuh.origin == /var/log/httpd/access_log\n```"
                      },
                      "Parse": {
                        "Parser expression": "Parser expressions facilitate the transformation of log entries into structured objects, offering an alternative to Grok by eliminating the need for explicit type declarations as these are predefined in the schema. Instead of regular expressions, these expressions utilize tailored parsers, enhancing precision.\n\nThe parser expressions are composed of various tokens or expressions, where these expressions can be any one of the following:\n\n['**Literals**, Direct characters that match input text exactly. with certain reserved characters that require escaping (used in other tokens), with the character `\\\\` , precisely: `<>?\\\\(`', 'E.g.: The following expression will match exactly that in the log line\\n`[Fri Sep 09 10:42:29.902022 2011] [core:error]`', '**Fields**, are expressions of the form  `<[?]field_name[/param1…]>`, where we can identify 4 different types of field expressions:', ['**Schema fields**: Directly correspond to fields defined in the schema, with the engine automatically applying the appropriate parser and can have parameters depending on the parser.', 'E.g.: `<source.ip>` will match any IPv4 or IPv6 and map it to the field `source.ip`.', '**Custom fields**: Are those that are not in the schema, in contrast to schema fields, custom fields use the text parser unless specified otherwise by the parameters. These are intended for temporary/auxiliary use.', 'Custom fields are indexed as text by default in open search, depending on the configuration open search may try to detect and index as other types.', 'E.g.: `<custom_field/long>` will match any number and map it to the field `custom_field`.', '**Optional fields**: we indicate that a field parse expression is optional writing the interrogation symbol `?` at the beginning of the expression. If the parsing fails it will continue with the next expressions.', 'E.g.: `<field1>|<?field2>|<field3>` will match anything between `|` symbols three times, and the second may be empty or not.', '**Field choice**: Expresses a choice between two field expressions, meaning one of the fields must match. We write two field expressions splitted by the interrogation symbol `?`. As the first choice we can only use parsers that do not require end token, if we use one that does the expression will fail to compile because the end tokens are not sent to the parser.', 'E.g.: `<source.ip>?<~/literal/->` will match an IP and map it to source ip or a hyphen, skipping it.', 'Note: `?` only needs to be scaped when it appears right after a field expression: `<source.ip>\\\\?...`'], '`Wildcards`, follows the same syntax and behaves the same as a custom field but has no name and does not map to any field. It is used to parse some pattern without extracting. Can be a optional or in a field choice also.', 'E.g.:`<~/byte>` will parse a byte value and continue.', 'E.g.:`Error Code: <~/long> Description: <message>` Here, `<~/long>` uses a wildcard to parse an integer error code that isn’t mapped to any field, essentially ignoring it while capturing the subsequent error description into message.', '**Optional groups**, make a logpar subexpression optional. The optional expression is denoted with `(?sub_expression)`. Used to make some more complex patterns optional where a simple optional field won’t suffice. It can contains any valid logpar expression with the exception of another optional group. An optional group can not contains another group, and two optional groups may not appear in a row.', 'E.g.:`[<source.ip>(?:<source.port>)]` will match any ip address optionally followed by a port separated by double dots, and being between brackets.']\n\n**Examples**:\n\nThis expression will capture an IP address or hostname into `client.ip` or `client.address`, and optionally capture a port into `server.port` if it is present.\n\n```\n<client.ip>?<client.address> connected to <server.ip>(?:<server.port>)\n```\n\nApache error parser:\n\n```\n# [Mon Dec 26 16:15:55.103522 2016] [mpm_prefork:notice] [pid 11379] AH00163: Apache/2.4.23 (Unix) configured -- resuming normal operations\n# [Mon Dec 26 16:15:55.103786 2016] [core:notice] [pid 11379] AH00094: Command line: '/usr/local/Cellar/httpd24/2.4.23_2/bin/httpd'\n# [Wed Oct 20 19:20:59.121211 2021] [rewrite:trace3] [pid 121591:tid 140413273032448] mod_rewrite.c(470): [client 10.121.192.8:38350] 10.121.192.8 - - [dev.elastic.co/sid#55a374e851c8][rid#7fb438083ac0/initial] applying pattern '^/import/?(.*)$' to uri '/'\n# [Wed Oct 20 19:20:59.121211 2021] [rewrite:trace3] [pid 121591:tid 140413273032448] mod_rewrite.c(470): [client milo.dom.com:513] 10.121.192.8 - - [dev.elastic.co/sid#55a374e851c8][rid#7fb438083ac0/initial] applying pattern '^/import/?(.*)$' to uri '/'\n# [Mon Dec 26 16:22:08 2016] [error] [client 192.168.33.1] File does not exist: /var/www/favicon.ico\n# [Fri Sep 09 10:42:29.902022 2011] [core:error] [pid 35708:tid 4328636416] [client 89.160.20.112] File does not exist: /usr/local/apache2/htdocs/favicon.ico\n# [Thu Jun 27 06:58:09.169510 2019] [include:warn] [pid 15934] [client 67.43.156.12:12345] AH01374: mod_include: Options +Includes (or IncludesNoExec) wasn't set, INCLUDES filter removed: /test.html\n# [Mon Dec 26 16:17:53 2016] [notice] Apache/2.2.22 (Ubuntu) configured -- resuming normal operations\n# [Mon Dec 26 16:22:00 2016] [error] [client 192.168.33.1] File does not exist: /var/www/favicon.ico, referer: http://192.168.33.72/\n# [Mon Dec 26 16:22:08 2016] [error] [client 192.168.33.1] File does not exist: /var/www/favicon.ico\nparse|event.original:\n    - \"[<@timestamp/Mon Dec 26 16:22:00 2016>] [<log.level>] [client <source.address>(?:<source.port>)] <message>\"\n\n    - \"[<@timestamp/%a %b %d %T %Y/en_US.UTF-8>] [<~apache.error.module>:<log.level>] [pid <process.pid>(?:tid <process.thread.id>)] [client <source.address>(?:<source.port>)] <message>\"\n\n    - \"[<@timestamp/%a %b %d %T %Y/en_US.UTF-8>] [<~apache.error.module>:<log.level>] [pid <process.pid>(?:tid <process.thread.id>)] <message>\"\n```",
                        "Schema fields and parsers": "Fields within the schema are bound to specific parsers that ensure the data matches the expected format. For example, date fields may require a specific time format, which is denoted using parameters following the field name in the format `<field_name/param_0/param_n>`. This allows for flexible data validation against predefined types or custom formats specified by additional parameters.\n\nFor standard fields defined in the schema, each field type has an associated parser. For instance, a field of type long (like `event.severity`) will utilize a numeric parser.\n\nCustom fields not defined in the schema default to using the text parser, which continues parsing until a specified delimiter or the end of the log entry. Fields at the end of a parser expression are interpreted as catch-all, capturing all remaining text in the log entry. This approach facilitates partial parsing where full matching is not required, ensuring flexibility in log analysis.\n\nFor example,  the case of `<tmp_field>c` this will parse everything until character `c` is found. It is possible to specify the parser name as the first argument, for example `<tmp_field/ip>c` will use the ip parser instead of the text parser. It is also possible to pass parameters to the parser, for example `<tmp_field/date/RFC822>c` parses the timestamp using the RFC822 format.",
                        "End tokens and field expressions": "Some parsers need an anchor token to stop parsing, i.e. the text parser used by default in all custom fields will parse any character until the end token is found. The end token is the literal following the field expression, or if the field expression is at the end it will parse the remaining string.\n\nE.g.:`<header>:<message>` will parse and capture any text up to a double dots in the header field, and the remaining of the log will be captured in the message field.\n\nThis implicates that two field expressions must be splited by a literal unless the first one does not need an end token, while `<custom/long><~>` is valid, as the long parsers does not need end token, `<text><~>` will be invalid.\n\nIn choice expressions the end token is the same for both field expressions, it is the literal right after the second field expression. E.g, `<custom_ip>?<~>|` will be valid, as both parsers require an end token, in this case the literal `|`. This implies the same as before, if one of the choices needs an end token, it must be followed by a literal.\n\nIn optional group expressions, i.e. when a field is followed by an optional group, there are multiple end tokens. The literal at the beginning of the optional group and the literal right after the group, meaning if a field needs an end token and is followed by an optional group, the group must start with a literal and a literal must appear right after the group.\n\nE.g.: `<custom_text>(?|<opt/long>):`, in this case the text parser will try to search for a `|`, so the optional group can be parsed, and if the optional group fails, then the text parser will use the symbol `:` as end token."
                      },
                      "Map": "Executes each operation of the list in order until the last operation. If any operation fails, it continues with the next one.\n\nIf all operations fail the stage is not marked as failed and continues to the next stage.\n\n**Type Validation**:\n\n['When mapping a custom field (not defined in the schema), it can store any value without additional type checks.', 'When mapping a field that belongs to the schema, a validation is performed based on the field’s type (e.g.,\\n`source.ip` → IP, `event.start` → timestamp).', ['If a fixed value is provided at build time and its type is invalid, the asset build fails immediately.', 'If the value is dynamically obtained, for example from a helper or another schema field, and it eventually fails\\ntype validation, it will fail at runtime. The field is then left unmapped to maintain the event’s integrity.']]\n\nExample:\n\n```\n- map:\n    - event.kind: event\n    - event.dataset: apache.access\n    - event.category: +array_append/web\n    - event.module: apache\n    - service.type: apache\n    - event.outcome: success\n```",
                      "Normalize/Enrichment": "The normalize stage is where the event undergoes transformations and adjustments after passing through the check and parse stages successfully. Composed of a list of sub-stages that are executed in the specified order. These sub-stages can include operations such as check, map, and parse.\n\n['**Check**: Applies conditional checks within the normalize context to determine if subsequent mappings or parsing should be executed.', '**Parse**: Further decomposes and extracts fields from the event data if required.', '**Map**: Transforms and assigns new values to fields in the event based on predefined rules.']\n\nEach set of sub-stages is processed sequentially. If a check and parse within a normalization block is successful, the corresponding map is executed, replicating the check, parse, and normalize stages of the asset.\n\nExample:\n\n```\nnormalize:\n  - map:\n      - wazuh.decoders: array_append(windows-sysmon)\n      - event.dataset: sysmon\n      - event.kind: event\n\n  # Only maps network.protocol if event.code is 22\n  - check: $event.code == '22'\n    map:\n      - network.protocol: dns\n\n  # Only maps resources if the check and parse stages succeeded\n  - check: $event.outcome == failure\n    parse|message:\n      - \"[<error.code/int>]<details>\"\n    map:\n      - resources: split($details, \",\")\n```",
                      "Output": "The Output Stage allows you to specify and configure the different outputs, defining the final destinations for events before they leave the Engine.\n\n```\noutputs:\n  - output_name: configuration\n```\n\nFor more details on the available output types and configurations, refer to [output documentation](ref-output.md)."
                    },
                    "Parsers": {
                      "Schema parsers": "These parsers are used automatically when a field of its type is used in a logpar expression.\n\nFor example, if you use the field `<event.start>` which is of type `date`, it will be parsed automatically by the date parser.\n\nThese parsers will generate fields which are type-compatible with Wazuh Indexer.\n\n| Type        | Parser       | Description                                                                                          |\n|-------------|--------------|------------------------------------------------------------------------------------------------------|\n| null        | -            | A null field can’t be indexed or searched. When a field is set to null, OpenSearch behaves as if that field has no values. |\n| boolean     | bool         | OpenSearch accepts true and false as boolean values. An empty string is equal to false.               |\n| float       | float        | Codified as decimal representation in string format. A single-precision 32-bit IEEE 754 floating point number, restricted to finite values. |\n| scaled_float| scaled_float | Codified as decimal representation in string format. The scaling factor is defined in the schema.    |\n| double      | double       | Codified as decimal representation in string format. A double-precision 64-bit IEEE 754 floating point number, restricted to finite values. |\n| long        | long         | Codified as decimal representation in string format. A signed 64-bit integer with a minimum value of `-2^63` and a maximum value of `2^63-1`. |\n| byte        | byte         | Codified as a decimal representation in string format. A signed 8-bit integer with a minimum value of `-128` and a maximum value of `127`. |\n| object      | -            | -                                                                                                    |\n| array       | -            | -                                                                                                    |\n| nested      | -            | -                                                                                                    |\n| text        | text         | A string sequence of characters that represent full-text values.                                     |\n| keyword     | text         | A string sequence of characters that represent full-text values.                                     |\n| ip          | ip           | A string with IPv4 or IPv6 address.                                                                  |\n| date        | date         | Date codified as string. All dates are converted to a unified date in UTC timezone.                  |\n| geo_point   | -            | -                                                                                                    |\n| binary      | binary       | A codified base64 string.                                                                            |\n\nAditionally we define some types for the purpose to use specific parsers, normally used to parse objects or structured types from an input text. This is the case for `url` field for example.\n\n| Type        | Parser     | Description                                                                                           |\n|-------------|------------|-------------------------------------------------------------------------------------------------------|\n| url         | uri        | Parses URI text and generates the URL object with all the parsed parts.                               |\n| useragent   | useragent  | Parses a user agent string. It does not build the user agent object; this can be done with the OpenSearch plugin. |"
                    },
                    "Debugging": {
                      "Filtering Logs by Executable Name": "You can retrieve logs specifically for the Engine using journald’s _COMM field:\n\n```\njournalctl _COMM=wazuh-engine\n```\n\nFor real-time monitoring of errors:\n\n```\njournalctl -f _COMM=wazuh-engine\n```",
                      "Filtering Logs by Severity": "To refine logs based on severity levels you can combine grep:\n\n```\njournalctl _COMM=wazuh-engine | grep info\n\nDec 18 14:59:22 WazPc env[12974]: 2024-12-18 14:59:22.663 12974:12974 info: Logging initialized.\nDec 18 14:59:22 WazPc env[12974]: 2024-12-18 14:59:22.668 12974:12974 fileDriver.cpp:231 at readCol(): debug: FileDriver readCol name: 'namespaces/system/decoder/core-hostinfo'.\nDec 18 14:59:22 WazPc env[12974]: 2024-12-18 14:59:22.669 12974:12974 main.cpp:166 at main(): info: Store initialized.\nDec 18 14:59:22 WazPc env[12974]: 2024-12-18 14:59:22.669 12974:12974 main.cpp:172 at main(): info: RBAC initialized.\n```\n\nAvailable severity levels:\n\n['**trace** – Provides highly detailed debugging information, useful for deep troubleshooting.', '**debug** – Contains diagnostic messages intended for developers to track execution flow.', '**info** – General operational logs that indicate normal Engine activity.', '**warning** – Highlights potential issues that do not impact functionality but may require attention.', '**error** – Reports issues that may cause incorrect behavior but do not stop the Engine.', '**critical** – Indicates severe failures that may result in the Engine stopping or becoming unstable.']",
                      "Traces": "Traces allow you to inspect the operational graph behavior, providing insights into how events are processed within the Engine. By using the tester endpoint (refer to the API documentation for details), you can specify several options to debug event processing effectively.\n\nAvailable trace options:\n\n['**Namespaces** – Filters traces to show only the assets under a specified namespace.', '**Graph History** – Displays all assets that processed a given event, allowing a complete view of its journey.', '**Traces** – Provides a detailed history of all operations performed by each asset (or a specified set of assets).']\n\nHere is a test example showing the graph history:\n\n```\ntraces:\n[🔴] decoder/zeek-x509/0 -> failed\n[🔴] decoder/zeek-weird/0 -> failed\n[🔴] decoder/zeek-traceroute/0 -> failed\n[🔴] decoder/zeek-stats/0 -> failed\n[🔴] decoder/zeek-software/0 -> failed\n[🔴] decoder/zeek-socks/0 -> failed\n[🔴] decoder/zeek-snmp/0 -> failed\n[🔴] decoder/zeek-smb_mapping/0 -> failed\n[🔴] decoder/zeek-smb_files/0 -> failed\n[🔴] decoder/apache-error/0 -> failed\n[🔴] decoder/zeek-smb_cmd/0 -> failed\n[🔴] decoder/zeek-ssl/0 -> failed\n[🔴] decoder/snort-json/0 -> failed\n[🔴] decoder/squid-access/0 -> failed\n[🔴] decoder/zeek-known_certs/0 -> failed\n[🔴] decoder/suricata/0 -> failed\n[🔴] decoder/zeek-irc/0 -> failed\n[🔴] decoder/microsoft-exchange-server-smtp/0 -> failed\n[🔴] decoder/snort-plaintext/0 -> failed\n[🔴] decoder/pfsense-firewall/0 -> failed\n[🔴] decoder/pfsense-dhcp/0 -> failed\n[🔴] decoder/apache-access/0 -> failed\n[🔴] decoder/snort-plaintext-csv/0 -> failed\n[🔴] decoder/zeek-sip/0 -> failed\n[🔴] decoder/pfsense-unbound/0 -> failed\n[🔴] decoder/iis/0 -> failed\n[🔴] decoder/zeek-signature/0 -> failed\n[🔴] decoder/modsecurity-nginx/0 -> failed\n[🔴] decoder/microsoft-dhcpv6/0 -> failed\n[🔴] decoder/zeek-conn/0 -> failed\n[🔴] decoder/zeek-modbus/0 -> failed\n[🔴] decoder/microsoft-exchange-server-imap4-pop3/0 -> failed\n[🔴] decoder/pfsense-php-fpm/0 -> failed\n[🔴] decoder/microsoft-exchange-server-messagetracking/0 -> failed\n[🔴] decoder/microsoft-exchange-server-httpproxy/0 -> failed\n[🔴] decoder/zeek-kerberos/0 -> failed\n[🔴] decoder/modsecurity-apache/0 -> failed\n[🔴] decoder/microsoft-dhcp/0 -> failed\n[🔴] decoder/zeek-pe/0 -> failed\n[🔴] decoder/windows-event/0 -> failed\n[🔴] decoder/zeek-capture_loss/0 -> failed\n[🔴] decoder/zeek-dhcp/0 -> failed\n[🔴] decoder/zeek-dnp3/0 -> failed\n[🔴] decoder/zeek-dns/0 -> failed\n[🔴] decoder/zeek-smtp/0 -> failed\n[🔴] decoder/zeek-http/0 -> failed\n[🔴] decoder/zeek-rfb/0 -> failed\n[🔴] decoder/zeek-files/0 -> failed\n[🔴] decoder/zeek-ftp/0 -> failed\n[🔴] decoder/zeek-ssh/0 -> failed\n[🔴] decoder/zeek-ocsp/0 -> failed\n[🔴] decoder/zeek-dce_rpc/0 -> failed\n[🔴] decoder/zeek-intel/0 -> failed\n[🔴] decoder/zeek-syslog/0 -> failed\n[🔴] decoder/zeek-known_hosts/0 -> failed\n[🔴] decoder/zeek-dpd/0 -> failed\n[🔴] decoder/zeek-known_services/0 -> failed\n[🔴] decoder/zeek-mysql/0 -> failed\n[🔴] decoder/zeek-ntlm/0 -> failed\n[🔴] decoder/zeek-tunnel/0 -> failed\n[🔴] decoder/zeek-notice/0 -> failed\n[🔴] decoder/zeek-ntp/0 -> failed\n[🔴] decoder/zeek-radius/0 -> failed\n[🟢] decoder/syslog/0 -> success\n[🔴] decoder/sysmon-linux/0 -> failed\n[🔴] decoder/system-auth/0 -> failed\n[🔴] decoder/snort-plaintext-syslog/0 -> failed\n[🔴] decoder/wazuh-dashboard/0 -> failed\n```\n\nShowing full traces:\n\n```\ntraces:\n[🟢] decoder/syslog/0 -> success\n  ↳ [/event/original: <event.start/Jun 14 15:16:01> <host.hostname> <TAG/alphanumeric/->[<process.pid>]:<~/ignore/ ><message>] -> Failure: Parse operation failed: Parser <event.start/Jun 14 15:16:01> failed at: 2018-08-14T14:30:02.203151+02:00 linux-sqrz systemd[4179]: Stopped target Basic System.\n  ↳ [/event/original: <event.start/Jun 14 15:16:01> <host.hostname> <TAG/alphanumeric/->:<~/ignore/ ><message>] -> Failure: Parse operation failed: Parser <event.start/Jun 14 15:16:01> failed at: 2018-08-14T14:30:02.203151+02:00 linux-sqrz systemd[4179]: Stopped target Basic System.\n  ↳ [/event/original: <event.start/2018-08-14T14:30:02.203151+02:00> <host.hostname> <TAG/alphanumeric/->[<process.pid>]: <message>] -> Success\n  ↳ event.kind: map(\"event\") -> Success\n  ↳ wazuh.decoders: array_append(\"syslog\") -> Success\n  ↳ related.hosts: array_append($host.hostname) -> Success\n  ↳ process.name: rename($TAG) -> Success\n  ↳ host.ip: array_append($tmp.host_ip) -> Failure: 'tmp.host_ip' not found\n```"
                    },
                    "F.A.Q": [
                      "A explanation of the time zone and how it works in the engine.",
                      "A explanation of diferent timestamp fields and how they are used."
                    ]
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 0]"
                },
                {
                  "title": "Api Reference",
                  "description": null,
                  "content": {
                    "API Reference": ""
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 1]"
                },
                {
                  "title": "Architecture",
                  "description": null,
                  "content": {
                    "Introduction": "```\n---\nconfig:\n  title: \"Simplified architecture\"\n  nodeSpacing: 30\n  rankSpacing: 25\n  flowchart:\n    curve: stepAfter\n    subGraphTitleMargin:\n      top: 20\n      bottom: 20\n---\nflowchart LR\n\nclassDef SubmoduleClass font-size:15px,stroke-width:2px,stroke-dasharray:10px,rx:15,ry:15\nclassDef ModuleClass  font-size:15px,stroke-width:2px,rx:15,ry:15\n\n%% ----------------------------------\n%%                  API\n%% ----------------------------------\n\nsubgraph apiModule[\"API\"]\n   direction LR\n   api_orchestrator@{ shape: stadium, label: \"Orchestrator manager\" }\n   api_kvdb@{ shape: stadium, label: \"KVDB manager\" }\n   api_metrics@{ shape: stadium, label: \"Metric manager\" }\n   api_geo@{ shape: stadium, label: \"Geo manager\" }\n   api_orchestrator ~~~ api_kvdb\n   api_metrics ~~~ api_geo\n\n   api_catalog@{ shape: disk, label: \"Catalog of assets\" }\n   api_policies@{ shape: disk, label: \"Policies\" }\n   api_policies ~~~ api_catalog\nend\napiModule:::ModuleClass\n\n\n%% ----------------------------------\n%%                  Geo module\n%% ----------------------------------\nsubgraph geoModule[\"Geolocator\"]\n  geo_mmdb@{ shape: disk, label: \"MaxMind DBs\" }\nend\ngeoModule:::ModuleClass\n\n%% ----------------------------------\n%%                  KVDB\n%% ----------------------------------\nsubgraph kvdbModule[\"KVDB\"]\n    direction TB\n    kvdb_db_2@{ shape: docs, label: \"Key-Value DataBases\" }\nend\nkvdbModule:::ModuleClass\n\n%% ----------------------------------\n%%              Global module\n%% ----------------------------------\nsubgraph globalModule[\"Global\"]\n    global_metrics(\"Metrics\")\n    global_logger(\"Logger\")\nend\nglobalModule:::ModuleClass\n\n%% ----------------------------------\n%%                  Server\n%% ----------------------------------\n\nsubgraph serverModule[\"Server\"]\n   direction RL\n   server_API>Server API]\n   server_engine>Server engine]\nend\nserverModule:::ModuleClass\n\n%% ----------------------------------\n%%           Storage\n%% ----------------------------------\nstorageModule@{ shape: cyl, label: \"Persistent</br>Storage\" }\nstorageModule:::ModuleClass\n\n%% ----------------------------------\n%%           Builder\n%% ----------------------------------\nsubgraph builderModule[\"Builder\"]\n builder_asset@{ shape: stadium, label: \"Builder asset\" }\n builder_policy@{ shape: stadium, label: \"Builder policy\" }\n builder_parser@{ shape: stadium, label: \"Builder parser\" }\n builder_hp@{ shape: stadium, label: \"Builder helper function\" }\n\n builder_policy ~~~ builder_asset --- builder_parser & builder_hp\n builder_parser --- builder_catalog_hf@{ shape: disk, label: \"Catalog of helper functions\" }\n builder_hp --- builder_catalog_parser@{ shape: disk, label: \"Catalog of parser\" }\n\nend\nbuilderModule:::ModuleClass\n\n%% ----------------------------------\n%%           Orchestrator\n%% ----------------------------------\nsubgraph orchestratorModule[\"Orchestrator\"]\n   direction RL\n   orchestrator_router@{ shape: stadium, label: \"Router\" }\n   orchestrator_tester@{ shape: stadium, label: \"Tester\" }\n   orchestrator_routerTable@{ shape: disk, label: \"Routes\" }\n   orchestrator_sessionTable@{ shape: disk, label: \"Session\" }\n   orchestrator_router --- orchestrator_routerTable\n   orchestrator_tester --- orchestrator_sessionTable\nend\norchestratorModule:::ModuleClass\n\nsubgraph backendModule[\"Backend\"]\n\nend\n\n%% ----------------------------------\n%%           Modules conexion\n%% ----------------------------------\nserverModule ------- orchestratorModule & apiModule\norchestratorModule ---- backendModule\nbuilderModule & apiModule --- geoModule & kvdbModule\napiModule --- storageModule\n\napiModule ------ builderModule\n\norchestratorModule  ------ builderModule\norchestratorModule ----- apiModule\nstorageModule --- builderModule\n\n```\n\n<center><i>Simplified architecture of the Wazuh engine</i></center>\n\nThe **Wazuh-Engine** is composed of multiple modules that work together to provide all engine functionality. Below is a summary of each module’s responsibilities and interactions.\n\n[]",
                    "Main Modules": [
                      "**Server**\nThe Server module exposes the Wazuh-Engine to the rest of the Wazuh-Server system. It creates two Unix stream sockets:",
                      [
                        "**engine.socket**: Receives events from Wazuh agents and forwards them to the Orchestrator module for processing.",
                        "**api.socket**: Exposes the engine’s REST API, forwarding requests to the API module. These requests manage engine state (policies, assets, routes, DB updates, etc.)."
                      ],
                      "**Orchestrator**\nThe Orchestrator module manages runtime routes and policy testing:",
                      [
                        "**Router**: Decides which policy to apply for each incoming event. It refers to a **Routes Table** that defines filters, priorities, and mappings to specific policies.",
                        "**Tester**: Evaluates events against the assigned policies. It uses a **Session Table** to store context/state of session. The Tester returns the outcome of policy checks (e.g., alerts and traces)."
                      ],
                      "**Backend**\nWhile Orchestrator handles routing and policy instantiation, the Backend module executes the code produced by the Builder module. The Backend is effectively the runtime environment for those policies.",
                      "**Builder**\nThe Builder module generates executable code based on policies and assets. It has four components:",
                      [
                        "**Policy**: Constructs code representing policy logic.",
                        "**Asset**: Constructs code for asset definitions.",
                        "**Parser**: Constructs code for any parsing functionalities.",
                        "**Helper Functions**: Builds code for auxiliary or common utility functions."
                      ],
                      "**API**\nThe API module manages interactions between the Wazuh-Engine and external modules or services via a REST interface. Its major components include:",
                      [
                        "**Orchestrator Manager**: Handles orchestrator-related tasks.",
                        "**KVDB Manager**: Manages access to the KVDB module.",
                        "**Metric Manager**: Interfaces with the metrics system in the Global module.",
                        "**Geo Manager**: Manages the Geo module.",
                        "**Catalog of Assets**: Maintains definitions of assets used across the engine.",
                        "**Policies**: Maintains definitions of policies used across the engine."
                      ],
                      "**KVDB**\nThe KVDB module provides key-value database functionality, using [RocksDB](https://rocksdb.org/) under the hood. It is typically employed by helper functions.",
                      "**Geo**\nThe Geo module manages geolocation data, relying on [MaxMind](https://www.maxmind.com/) databases. It exposes an internal API for updating and querying geolocation information.",
                      "**Persistent Storage**\nThe Storage module oversees long-term persistence for policies, assets, sessions, and other data (e.g., routes, schemas, configurations). It currently uses the local file system.",
                      "**Global**\nThe Global module offers cross-cutting engine resources:",
                      [
                        "**Metrics**: Tracks performance and usage statistics for Wazuh-Engine.",
                        "**Logger**: Centralizes logging features for all modules."
                      ]
                    ],
                    "Module: Server": "The **Server** module provides the primary interface for both incoming agent events and external API requests:\n\n['**engine.socket**:', ['Receives raw events from Wazuh agents.', 'Forwards these events to the Orchestrator for routing and policy application.'], '**api.socket**:', ['Exposes the REST API of the Wazuh-Engine.', 'Forwards requests to the API module, which then manages tasks such as policy updates, asset management, and configuration changes.']]\n\n[]",
                    "Module: Orchestrator": "The **Orchestrator** determines how incoming events are routed and tested against policies:\n\n['**Router**:', ['Uses a **Routes Table** to map events to policies based on defined filters and priorities.', 'Example of a routes table:', '| Route name (ID)   | Priority | Filter        | Policy                   |\\n|-------------------|----------|---------------|--------------------------|\\n| router_example    | 1        | filter_1      | policy_1                 |\\n| ...               | ...      | filter_2      | policy_2                 |\\n| default           | 255      | * (catch-all) | wazuh-default-policy     |'], '**Tester**:', ['Uses a **Session Table** to maintain session state.', 'Receives an event and a sesion, then produces a result (alerts sample and traces).']]\n\n[]",
                    "Module: Backend": "The **Backend** executes the compiled policy and routing code generated by the Builder module. It effectively serves as the runtime environment for custom logic crafted by the Builder and orchestrated by the Orchestrator.\n\n[]",
                    "Module: Geo": "The **Geo** module offers geolocation capabilities:\n\n['Relies on [MaxMind](https://www.maxmind.com/) databases.', 'Provides an internal interface for updating these databases and querying geolocation data.']\n\n[]",
                    "Module: KVDB": "The **KVDB** module manages key-value databases for various engine operations:\n\n['Primarily used by helper functions.', 'Internally uses [RocksDB](https://rocksdb.org/) for data management.']\n\n[]",
                    "Module: Persistent Storage": "The **Persistent Storage** module handles local storage for:\n\n['Policies, routes, assets, sessions, configurations, and other engine-related data.', 'Uses the file system for data persistence.']\n\n[]",
                    "Module: Global": "The **Global** module unifies core engine-wide features:\n\n['**Metrics**: Collects real-time performance statistics and usage data.', '**Logger**: Centralizes logging, enabling consistent log output for all modules.']\n\n[]",
                    "Module: Builder": "The **Builder** module translates high-level definitions of policies, assets, parsers, and helper functions into executable code:\n\n['**Policy**: Generates policy-related logic.', '**Asset**: Defines and compiles asset representation.', '**Parser**: Builds parser logic.', '**Helper Functions**: Compiles shared utility code used by assets.']\n\n[]",
                    "Module: API": "The **API** module offers a REST interface for external tools and internal modules:\n\n['**Orchestrator Manager**: Oversees orchestrator tasks (e.g., route administration).', '**KVDB Manager**: Interfaces with KVDB for data operations.', '**Metric Manager**: Exposes engine metrics for monitoring.', '**Geo Manager**: Manages geolocation data updates and queries.', '**Catalog of Assets**: Maintains a registry of asset definitions.', '**Policies**: Maintains a registry of policies used throughout the engine.']\n\n[]\n\n**Note**: This architecture is intentionally simplified to illustrate high-level relationships and flows. For more specific implementation details (such as internal data structures, APIs, or design patterns), please refer to the respective module documentation or source code.\n\n[]"
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 2]"
                },
                {
                  "title": "Internal Development Tools",
                  "description": null,
                  "content": {
                    "Api-communication": "This library provides a client interface for local communication with the Wazuh engine. It is designed to facilitate seamless interaction between components during development and testing.\n\nFor more details, refer to the README on src/engine/tools/api-communication/README.md\n\n[]",
                    "Engine Suite": {
                      "Key Tools in `engine-suite`:": [
                        "**engine-clear**: Clears specific configurations or data from the engine.",
                        "**engine-decoder**: Manages and tests decoders used by the engine.",
                        "**engine-diff**: Compares configurations or data for differences.",
                        "**engine-integration**: Handles integrations with external systems.",
                        "**engine-policy**: Manages policies within the Wazuh engine.",
                        "**engine-router**: Configures and tests routing within the engine.",
                        "**engine-test**: Provides utilities for testing engine functionality."
                      ]
                    },
                    "Engine Test Utils": "A Python library containing utility functions and helpers for testing scripts that interact with the Wazuh engine.\nThese utilities streamline the creation and execution of test cases.\n\nFor more details, refer to the README on src/engine/test/engine-test-utils/README.md\n\n[]",
                    "Engine Helper Test": "This tool automates the generation of test cases to verify the correct end-to-end operation of helper functions used\nin asset. It uses YAML files to define the parameters of helper functions and generates corresponding test cases\nautomatically. The tool also generates documentation for helper functions.\n\n**Features:**\n\n['YAML-based test case generation.', 'Simplifies testing of helper functions.', 'Generate documentation for helper functions.']\n\nFor more details, refer to the README on src/engine/test/helper-test/README.md\n\n[]",
                    "Engine Health Test": "The `engine-health-test` tool performs comprehensive health checks on the Wazuh ruleset.\nIt runs a series of automated tests against the Wazuh engine to ensure the ruleset operates as expected.\nThis tool is essential for validating the integrity and functionality of the ruleset.\n\nFor more details, refer to the README on src/engine/test/health_test/README.md\n\n**Location:** `src/engine/test/health_test/engine-health-test`\n\n[]",
                    "Engine Integration Test": "The `engine-integration-test` tool is designed to test the integration of the Wazuh engine with external systems.\nIt verifies the correct operation of integrations and ensures that data is correctly processed and forwarded to the\nengine.\n\nFor more details, refer to the README on src/engine/test/integration_test/README.md."
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 3]"
                },
                {
                  "title": "Summary",
                  "description": null,
                  "content": {
                    "Index": {
                      "Filter": [
                        "[array_contains](#array_contains)",
                        "[array_contains_any](#array_contains_any)",
                        "[array_not_contains](#array_not_contains)",
                        "[array_not_contains_any](#array_not_contains_any)",
                        "[binary_and](#binary_and)",
                        "[contains](#contains)",
                        "[ends_with](#ends_with)",
                        "[exists](#exists)",
                        "[exists_key_in](#exists_key_in)",
                        "[int_equal](#int_equal)",
                        "[int_greater](#int_greater)",
                        "[int_greater_or_equal](#int_greater_or_equal)",
                        "[int_less](#int_less)",
                        "[int_less_or_equal](#int_less_or_equal)",
                        "[int_not_equal](#int_not_equal)",
                        "[ip_cidr_match](#ip_cidr_match)",
                        "[is_array](#is_array)",
                        "[is_boolean](#is_boolean)",
                        "[is_ipv4](#is_ipv4)",
                        "[is_ipv6](#is_ipv6)",
                        "[is_not_array](#is_not_array)",
                        "[is_not_boolean](#is_not_boolean)",
                        "[is_not_object](#is_not_object)",
                        "[is_not_string](#is_not_string)",
                        "[is_number](#is_number)",
                        "[is_object](#is_object)",
                        "[is_public_ip](#is_public_ip)",
                        "[is_string](#is_string)",
                        "[is_test_session](#is_test_session)",
                        "[keys_exist_in_list](#keys_exist_in_list)",
                        "[kvdb_match](#kvdb_match)",
                        "[kvdb_not_match](#kvdb_not_match)",
                        "[match_value](#match_value)",
                        "[number_equal](#number_equal)",
                        "[number_greater](#number_greater)",
                        "[number_greater_or_equal](#number_greater_or_equal)",
                        "[number_less](#number_less)",
                        "[number_less_or_equal](#number_less_or_equal)",
                        "[number_not_equal](#number_not_equal)",
                        "[regex_match](#regex_match)",
                        "[starts_with](#starts_with)",
                        "[string_equal](#string_equal)",
                        "[string_greater](#string_greater)",
                        "[string_less](#string_less)",
                        "[string_less_or_equal](#string_less_or_equal)",
                        "[string_not_equal](#string_not_equal)"
                      ],
                      "Map": [
                        "[as](#as)",
                        "[concat](#concat)",
                        "[concat_any](#concat_any)",
                        "[date_from_epoch](#date_from_epoch)",
                        "[decode_base16](#decode_base16)",
                        "[downcase](#downcase)",
                        "[float_calculate](#float_calculate)",
                        "[geoip](#geoip)",
                        "[get_date](#get_date)",
                        "[hex_to_number](#hex_to_number)",
                        "[int_calculate](#int_calculate)",
                        "[ip_version](#ip_version)",
                        "[join](#join)",
                        "[regex_extract](#regex_extract)",
                        "[sha1](#sha1)",
                        "[system_epoch](#system_epoch)",
                        "[to_int](#to_int)",
                        "[to_string](#to_string)",
                        "[upcase](#upcase)"
                      ],
                      "Transformation": [
                        "[array_append](#array_append)",
                        "[array_append_any](#array_append_any)",
                        "[array_append_unique](#array_append_unique)",
                        "[array_append_unique_any](#array_append_unique_any)",
                        "[delete](#delete)",
                        "[erase_custom_fields](#erase_custom_fields)",
                        "[get_key_in](#get_key_in)",
                        "[kvdb_decode_bitmask](#kvdb_decode_bitmask)",
                        "[kvdb_get](#kvdb_get)",
                        "[kvdb_get_array](#kvdb_get_array)",
                        "[kvdb_get_merge](#kvdb_get_merge)",
                        "[kvdb_get_merge_recursive](#kvdb_get_merge_recursive)",
                        "[merge](#merge)",
                        "[merge_key_in](#merge_key_in)",
                        "[merge_recursive_key_in](#merge_recursive_key_in)",
                        "[parse_alphanumeric](#parse_alphanumeric)",
                        "[parse_between](#parse_between)",
                        "[parse_binary](#parse_binary)",
                        "[parse_bool](#parse_bool)",
                        "[parse_byte](#parse_byte)",
                        "[parse_csv](#parse_csv)",
                        "[parse_double](#parse_double)",
                        "[parse_dsv](#parse_dsv)",
                        "[parse_file](#parse_file)",
                        "[parse_float](#parse_float)",
                        "[parse_fqdn](#parse_fqdn)",
                        "[parse_ip](#parse_ip)",
                        "[parse_json](#parse_json)",
                        "[parse_key_value](#parse_key_value)",
                        "[parse_quoted](#parse_quoted)",
                        "[parse_uri](#parse_uri)",
                        "[parse_useragent](#parse_useragent)",
                        "[parse_xml](#parse_xml)",
                        "[rename](#rename)",
                        "[replace](#replace)",
                        "[split](#split)",
                        "[trim](#trim)"
                      ]
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 4]"
                },
                {
                  "title": "Output Reference",
                  "description": null,
                  "content": {
                    "File": {
                      "Signature": "```\nfile:\n    path: ${PATH}\n```",
                      "Parameters": "| Name | type | required | Description |\n|------|------|----------|-------------|\n| path | string | yes | Absolute path to the file where the alerts will be written. The path should be writable by the user `wazuh-server`. |",
                      "Asset example": "```\nname: output/file-output-integrations/0\n\nmetadata:\n  module: wazuh\n  title: file output event\n  description: Output integrations events to a file\n  compatibility: >\n    This decoder has been tested on Wazuh version 5.x\n  versions:\n    - 5.x\n  author:\n    name: Wazuh, Inc.\n    date: 2022/11/08\n  references:\n    - \"\"\n\noutputs:\n  - file:\n      path: /var/lib/wazuh-server/engine/alerts-ecs.json\n```"
                    },
                    "Indexer": {
                      "Signature": "```\nwazuh-indexer:\n    index: ${INDEX}\n```",
                      "Parameters": "| Name | type | required | Description |\n|------|------|----------|-------------|\n| index | string | yes | Index name where the alerts will be indexed. Should be a valid Elasticsearch index name and start with `wazuh-`. |",
                      "Asset example": "```\nname: output/indexer/0\n\nmetadata:\n  module: wazuh\n  title: Indexer output event\n  description: Output integrations events to wazuh-indexer\n  compatibility: >\n    This decoder has been tested on Wazuh version 5.0\n  versions:\n    - \"\"\n  author:\n    name: Wazuh, Inc.\n    date: 2024/12/01\n  references:\n    - \"\"\n\noutputs:\n  - wazuh-indexer:\n      index: wazuh-alerts-$(DATE)\n```\n\n['[!TIP]\\nThe `$(DATE)` macro is replaced by the current date in the format `YYYY.MM.DD` when the alert is indexed.']"
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 5]"
                },
                {
                  "title": "Schema parser reference",
                  "description": null,
                  "content": {
                    "Boolean parser": {
                      "Behavior": [
                        "The Boolean parser strictly matches \"true\" or \"false\" without supporting parameters or alternative representations\nlike \"yes\"/\"no\" or \"on\"/\"off\".",
                        "Is key insensitive.",
                        "The parser does not require an end token."
                      ],
                      "Signature": "```\n<field/bool>\n```",
                      "Examples": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <output_field/bool>\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"input_field\": \"true\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"true\",\n  \"output_field\": true\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"input_field\": \"False\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"False\",\n  \"output_field\": false\n}\n```\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"input_field\": \"Not a boolean\"\n}\n```\n\nFailed parsing, the input is not a valid boolean.\n\n**Example 4**\n\nEvent input\n\n```\n{\n  \"input_field\": \"1\"\n}\n```\n\nFailed parsing, the input is not a valid boolean.\n\n**Example 5**\n\nEvent input\n\n```\n{\n  \"input_field\": \"FALSE\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"FALSE\",\n  \"output_field\": false\n}\n```"
                    },
                    "Long parser": {
                      "Behavior": [
                        "Accepts strings that represent integer values, including those prefixed with a '-' sign to denote negative numbers.",
                        "This parser can process numbers with decimal points but discards any fractional part,\neffectively rounding down to the nearest whole number.",
                        "It does not require a specific end token"
                      ],
                      "Signature": "```\n<field/long>\n```",
                      "Examples": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <output_field/long>\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"input_field\": \"123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"123\",\n  \"output_field\": 123\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"input_field\": \"-123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"-123\",\n  \"output_field\": -123\n}\n```\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"input_field\": \"123.456\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"123.456\",\n  \"output_field\": 123\n}\n```\n\nSuccess  with rounding\n\n**Example 4**\n\nEvent input\n\n```\n{\n  \"input_field\": \"Not a number\"\n}\n```\n\nFailed parsing, the input is not a valid long.\n\n**Example 5**\n\nEvent input\n\n```\n{\n  \"input_field\": \"1.23\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"1.23\",\n  \"output_field\": 1\n}\n```"
                    },
                    "Double parser": {
                      "Behavior": [
                        "Accepts numbers with optional leading '-' signs to indicate negative values.",
                        "Supports numbers with or without a decimal point, and can interpret numbers in scientific notation (e.g., `1.23E+10`).",
                        "It does not require a specific end token"
                      ],
                      "Signature": "```\n<field/double>\n```",
                      "Examples": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <output_field/double>\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"input_field\": \"123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"123\",\n  \"output_field\": 123.0\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"input_field\": \"-123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"-123\",\n  \"output_field\": -123.0\n}\n```\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"input_field\": \"2.99792458E8\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"2.99792458E8\",\n  \"output_field\": 299792458.0\n}\n```\n\n**Example 4**\n\nEvent input\n\n```\n{\n  \"input_field\": \"Not a number\"\n}\n```\n\nFailed parsing, the input is not a valid double.\n\n**Example 5**\n\nEvent input\n\n```\n{\n  \"input_field\": \"abc123\"\n}\n```\n\nFailed parsing, the input is not a valid double.\n\n**Example 6**\n\nEvent input\n\n```\n{\n  \"input_field\": \"1,234\"\n}\n```\n\nFailed parsing, commas are not supported.\n\n**Example 7**\n\nEvent input\n\n```\n{\n  \"input_field\": \"1.23\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"1.23\",\n  \"output_field\": 1.23\n}\n```"
                    },
                    "Float parser": {
                      "Behavior": [
                        "Accepts both integers and decimals, with or without a negative sign.",
                        "Efficiently processes numbers expressed in scientific notation (e.g., 2.5E3).",
                        "Does not require a specific end token."
                      ],
                      "Signature": "```\n<field/scaled_float>\n```",
                      "Examples": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <output_field/scaled_float>\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"input_field\": \"123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"123\",\n  \"output_field\": 123.0\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"input_field\": \"-123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"-123\",\n  \"output_field\": -123.0\n}\n```\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"input_field\": \"2.5E3\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"2.5E3\",\n  \"output_field\": 2500.0\n}\n```\n\n**Example 4**\n\nEvent input\n\n```\n{\n  \"input_field\": \"Not a number\"\n}\n```\n\nFailed parsing, the input is not a valid scaled float.\n\n**Example 5**\n\nEvent input\n\n```\n{\n  \"input_field\": \"1.0E-2\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"1.0E-2\",\n  \"output_field\": 0.01\n}\n```"
                    },
                    "Byte parser": {
                      "Behavior": [
                        "Strictly limits the accepted values to the defined byte range, rejecting inputs outside -128 to 127.",
                        "Does not require a specific end token.",
                        "Accepts numeric strings that may optionally include a '-' sign to indicate negative values."
                      ],
                      "Signature": "```\n<field/byte>\n```",
                      "Examples": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <status_code/byte>\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"input_field\": \"123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"123\",\n  \"status_code\": 123\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"input_field\": \"-123\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"-123\",\n  \"status_code\": -123\n}\n```\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"input_field\": \"128\"\n}\n```\n\nFailed parsing, the input is not a valid byte (out of range).\n\n**Example 4**\n\nEvent input\n\n```\n{\n  \"input_field\": \"Not a number\"\n}\n```\n\nFailed parsing, the input is not a valid byte."
                    },
                    "Text parser": {
                      "Behavior": [
                        "Captures all characters in the input string until it reaches a designated end token.",
                        "If no specific end token is provided, the parser consumes all characters up to the end of the input string"
                      ],
                      "Signature": "```\n<field/text>\n```",
                      "Examples: With prefix": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|event.original:\n - \"Prefix: <output_field/text>\"\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Prefix: This is a test\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"event.original\": \"Prefix: This is a test\",\n  \"output_field\": \"This is a test\"\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Prefix: \"\n}\n```\n\nFailed parsing, no text to parse.\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Some text\"\n}\n```\n\nFailed parsing, no prefix to match.",
                      "Examples 2: With Prefix and suffix": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|event.original:\n - \"Prefix: <output_field/text> Suffix\"\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Prefix: This is a test Suffix\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"event.original\": \"Prefix: This is a test Suffix\",\n  \"output_field\": \"This is a test\"\n}\n```\n\n**Example 2**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Prefix: - Suffix\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"event.original\": \"Prefix: - Suffix\",\n  \"output_field\": \"-\"\n}\n```\n\n**Example 3**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Prefix: Suffix\"\n}\n```\n\nFailed parsing, no text to parse.\n\n**Example 4**\n\nEvent input\n\n```\n{\n  \"event.original\": \"Some text\"\n}\n```\n\nFailed parsing, no prefix to match."
                    },
                    "IP parser": {
                      "Behavior": [
                        "Extracts and validates IP addresses in both IPv4 and IPv6 formats.",
                        "Does not require a specific end token."
                      ],
                      "Signature": "```\n<field/ip>\n```",
                      "Examples": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <output_field/ip>\n```\n\n**Example 1**\n\nInput event\n\n```\n{\n  \"input_field\": \"192.168.1.1\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"192.168.1.1\",\n  \"output_field\": \"192.168.1.1\"\n}\n```\n\n**Example 2**\n\nInput event\n\n```\n{\n  \"input_field\": \"2001:0db8:85a3:0000:0000:8a2e:0370:7334\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"2001:0db8:85a3:0000:0000:8a2e:0370:7334\",\n  \"output_field\": \"2001:0db8:85a3:0000:0000:8a2e:0370:7334\"\n}\n```\n\n**Example 3**\n\nInput event\n\n```\n{\n  \"input_field\": \"Not an IP address\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"Not an IP address\"\n}\n```\n\nFailed parsing, the input is not a valid IP address."
                    },
                    "Date parser": {
                      "Behavior": [
                        "Format Matching: Attempts to match the input date string against the specified format.",
                        "Adjustment and Validation: Misformatted or incomplete date entries may result in adjustments based on default values (like assuming the current year when it's missing) or parsing failures, depending on the format's requirements.",
                        "Standardization: Successfully parsed dates are systematically converted to the ISO 8601 format, enhancing data consistency across systems.",
                        "Custom Field Applicability: Can be manually applied to custom fields where specific date parsing is required",
                        "Does not require a specific end token."
                      ],
                      "Signature": "```\n<field/date/Format/[Locale]>\n```\n\n['`Format`: Date format string or predefined format name.', '`Locale`: Optional locale string for date parsing. The default locale is \"en_US.UTF-8\", which handles the most\\ncommonly encountered date formats.']\n\n***Supported formats***\n\nThe parser supports several predefined date formats which are commonly used in various logging standards, such as syslog,\nRFCs, and more. Users can specify a custom format using the [syntax from Howard Hinnant's date library](https://howardhinnant.github.io/date/date.html#from_stream_formatting), or choose from\npredefined formats like RFC3339, ISO8601, etc.\n\n| Predefined Format      | Equivalent expression | Match example |\n|-----------------------|---------------------|-----------------------------------|\n| ANSIC                 | %a %b %d %T %Y      | Mon Jan _2 15:04:05 2006          |\n| UnixDate              | %a %b %d %T %Z %Y   | Mon Jan _2 15:04:05 MST 2006      |\n| RubyDate              | %a %b %d %T %z %Y   | Mon Jan 02 15:04:05 -0700 2006    |\n| RFC822                | %d %b %y %R %Z      | 02 Jan 06 15:04 MST               |\n| RFC822Z               | %d %b %y %R %z      | 02 Jan 06 15:04 -0000             |\n| RFC850                | %A, %d-%b-%y %T %Z  | Monday, 02-Jan-06 15:04:05 MST    |\n| RFC1123               | %a, %d %b %Y %T %Z  | Mon, 02 Jan 2006 15:04:05 MST     |\n| RFC1123Z              | %a, %d %b %Y %T %z  | Mon, 02 Jan 2006 15:04:05 -0700   |\n| RFC3339               | %FT%TZ%Ez           | 2006-01-02T15:04:05Z07:00         |\n| RFC3164               | %b %d %R:%6S %Z     | Mar 1 18:48:50.483 UTC            |\n| SYSLOG                | %b %d %T            | Jun 14 15:16:01                   |\n| ISO8601               | %FT%T%Ez            | 2018-08-14T14:30:02.203151+02:00  |\n| ISO8601Z              | %FT%TZ              | 2018-08-14T14:30:02.203151Z       |\n| HTTPDATE              | %d/%b/%Y:%T %z      | 26/Dec/2016:16:22:14 +0000        |\n| NGINX_ERROR           | %Y/%m/%d %T         | 2019/10/30 23:26:34               |\n| POSTGRES              | %F %H:%M:%6S %Z     | 2021-02-14 10:45:33 UTC           |",
                      "Examples: Without locale": "**Parser configuration**\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|event_time:\n  - <tmp_time/date/RFC3339>\n```\n\n**Example 1**\nEvent input\n\n```\n{\n  \"event_time\": \"2020-01-02T03:04:05Z07:00\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"event_time\": \"2020-01-02T03:04:05Z07:00\",\n  \"tmp_time\": \"2020-01-01T20:04:05.000Z\"\n}\n```\n\n**Example 2**\n\nInput event\n\n```\n{\n  \"event_time\": \"Not a date\"\n}\n```\n\nFailed parsing, the input is not a valid date.\n\n**Example 3**\n\nInput event\n\n```\n{\n  \"event_time\": \"2020-01-02T03:04:05\"\n}\n```\n\nFailed parsing, the input is not a valid date, missing timezone.",
                      "Examples: With locale": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|event_time:\n  - <event.start/HTTPDATE/en_GB.UTF-8>\n```\n\n['[!NOTE]\\nThe `date` parser use is implicit, because the parser is automatically applied to schema fields defined as type `date`\\nlike `event.start`.']\n\n**Example 1**\n\nInput event\n\n```\n{\n  \"event_time\": \"02/Jan/2020:03:04:05 +0000\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"event_time\": \"02/Jan/2020:03:04:05 +0000\",\n  \"event.start\": \"2020-01-02T03:04:05.000Z\"\n}\n```\n\n**Example 2**\n\nInput event\n\n```\n{\n  \"event_time\": \"Not a date\"\n}\n```\n\nFailed parsing, the input is not a valid date."
                    },
                    "Binary parser": {
                      "Behavior": [
                        "Validates base64 encoded strings, ensuring they conform to the base64 encoding standard.\nensuring the character set includes only A-Z, a-z, 0-9, '+', '/', and '=' for end padding.",
                        "Does not require a specific end token."
                      ],
                      "Signature": "```\n<field/binary>\n```",
                      "Example": "**Parser configuration**\n\nFor the following examples, the parser configuration is as follows:\n\n```\nparse|input_field:\n  - <output_field/binary>\n```\n\n**Example 1**\n\nEvent input\n\n```\n{\n  \"input_field\": \"SGVsbG8sIFdvcmxkIQ==\"\n}\n```\n\nOutput after parse\n\n```\n{\n  \"input_field\": \"SGVsbG8sIFdvcmxkIQ==\",\n  \"output_field\": \"Hello, World!\"\n}\n```\n\n**Example 2**\n\nInput event\n\n```\n{\n  \"input_field\": \"Not a base64 string\"\n}\n```\n\nFailed parsing, the input is not a valid base64 string.\n\n**Example 3**\n\nInput event\n\n```\n{\n  \"input_field\": \"SGVsbG8sIFdvcmxkIQ\"\n}\n```\n\nFailed parsing, the input is not a valid base64 string, missing padding.\n\n**Input event**\n\n```\n{\n  \"input_field\": \"SGVsbG8sIFdvcmxkIQ@=\"\n}\n```\n\nFailed parsing, the input is not a valid base64 string, invalid character.\n\n[]"
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1, \"subpages\", 6]"
                }
              ],
              "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 1]"
            },
            {
              "title": "Inventory Harvester",
              "description": "Documentation section: inventory-harvester",
              "content": {},
              "metadata": {
                "type": "directory",
                "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/modules/inventory-harvester"
              },
              "subpages": [
                {
                  "title": "InventoryHarvester",
                  "description": null,
                  "content": {
                    "Overview": {
                      "Key Responsibilities": [
                        "**Receive** inventory data (e.g., hardware/software/network details, FIM data) via flatbuffer messages.",
                        "**Index** all collected data in the Wazuh Indexer in accordance with global state requirements.",
                        "**Manage** bulk operations, reducing overhead and improving overall performance.",
                        "**Integrate** seamlessly with FIM and other Wazuh modules that rely on inventory data."
                      ],
                      "Data Flow": [
                        "**Message Ingestion**",
                        [
                          "Both the `System inventory` module and the `FIM` module event messages arrive to the manager.",
                          "Flatbuffer messages arrive to the Inventory Harvester module through the router."
                        ],
                        "**Deserialization & Validation**",
                        [
                          "Each message is deserialized, validated, and processed for indexing."
                        ],
                        "**Indexer Connector**",
                        [
                          "Validated data is batched and sent to the Wazuh Indexer in bulk, minimizing overhead."
                        ],
                        "**Storage**",
                        [
                          "The data is stored in a dedicated global state index, following Wazuh Common Schemas (WCS). There is one index for each type of inventory data."
                        ],
                        "**Monitoring & Feedback**",
                        [
                          "Any indexing issues or failures are reported to the relevant components for retries or error handling."
                        ]
                      ],
                      "Supported modules": [
                        "**System inventory**",
                        [
                          "System: Operating system running on agent.",
                          "Programs: Installed programs in the agent endpoint.",
                          "Processes: Running programs in the agent endpoint at the moment of the scan.",
                          "Hotfixes: Installed vulnerability and fix patches for Windows system endpoints.",
                          "Hardware: Installed CPU and memory information.",
                          "Network protocol: Network protocol shows information for detected network interfaces.",
                          "Network address: Current network connection.",
                          "Network interface: Descriptive information of network interfaces.",
                          "Ports: Details about open ports in the agent endpoint.",
                          "Users: Detailed information for each user registered in the OS for control access and permissions.",
                          "Groups: Detailed information for each group present in the OS for control access and permissions."
                        ],
                        "**File Integrity Monitoring**",
                        [
                          "Files: Monitored files",
                          "Registries: Monitored registries for Windows system endpoints."
                        ]
                      ]
                    },
                    "Related Epic": "FIM (File Integrity Monitoring) and Inventory modules can leverage global queries in the Wazuh Indexer to perform complex searches and filtering on collected data. This capability significantly enhances Wazuh’s security and compliance features.\n\n['**Epic**: [#27894 – Global Queries for FIM and Inventory Modules](https://github.com/wazuh/wazuh/issues/27894)', '**Responsible Team**: [@wazuh/devel-xdrsiem-server](https://github.com/orgs/wazuh/teams/devel-xdrsiem-server)']\n\n[]",
                    "Functional Requirements": [
                      "Users can run **built-in** visualizations and queries on **FIM** and **System Inventory** global state data.",
                      "Users can create **custom** visualizations and queries for the same data.",
                      "Users **cannot edit or delete** a global state index or its data directly.",
                      "When an **agent is removed**, the global state data reflects the removal.",
                      "Supports both **Wazuh server cluster** and **Wazuh server standalone** deployments.",
                      "**FIM** and **System Inventory** schemas must comply with **WCS**."
                    ],
                    "Non-Functional Requirements": [
                      "Global state changes are reflected in the Wazuh Indexer based on whichever of the following occurs first:",
                      [
                        "**25,000** accumulated change events.",
                        "**20 seconds** after the last bulk operation."
                      ],
                      "Hardware resource usage (CPU, memory, storage) must stay within acceptable limits.",
                      "No new external libraries, frameworks, or dependencies are introduced."
                    ],
                    "Implementation Restrictions": [
                      "**FIM** and **system inventory** global state data resides in the Wazuh Indexer.",
                      "The **Indexer connector** handles the creation of required indices.",
                      "Permissions to edit or delete **global state indices** differ from regular user permissions.",
                      "**Manager-Indexer synchronization** is guaranteed when both operate under the same Wazuh version.",
                      "FIM and system inventory fields follow a **common schema** wherever possible.",
                      "The **UI** for FIM and system inventory is designed to mirror the **Vulnerability Detector** interface for consistency."
                    ],
                    "Implementation Missing Features": [
                      "Currently, the events indexation for **agent 000 (Wazuh manager)** is not supported."
                    ]
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 2, \"subpages\", 0]"
                },
                {
                  "title": "Api Reference",
                  "description": null,
                  "content": {
                    "API Reference": "The Inventory Harvester module indexes FIM and Inventory data into dedicated indices within the Wazuh-indexer (OpenSearch). So the information is retrieved by using the Opensearch API (ref: https://opensearch.org/docs/latest/api-reference/).\n\nFor a quick reference, the table below lists the component and its specific query.\n\n| Component                    | Query                                            |\n|------------------------------|--------------------------------------------------|\n| Inventory OS                 | GET /wazuh-states-inventory-system-*/_search     |\n| Inventory Packages           | GET /wazuh-states-inventory-packages-*/_search   |\n| Inventory Processes          | GET /wazuh-states-inventory-processes-*/_search  |\n| Inventory Ports              | GET /wazuh-states-inventory-ports-*/_search      |\n| Inventory Hardware           | GET /wazuh-states-inventory-hardware-*/_search   |\n| Inventory Hotfixes           | GET /wazuh-states-inventory-hotfixes-*/_search   |\n| Inventory Network Addresses  | GET /wazuh-states-inventory-networks-*/_search   |\n| Inventory Network Protocols  | GET /wazuh-states-inventory-protocols-*/_search  |\n| Inventory Network Interfaces | GET /wazuh-states-inventory-interfaces-*/_search |\n| Inventory Users              | GET /wazuh-states-inventory-users-*/_search      |\n| Inventory Groups             | GET /wazuh-states-inventory-groups-*/_search     |\n| FIM Files                    | GET /wazuh-states-fim-files-*/_search            |\n| FIM Registries               | GET /wazuh-states-fim-registries-*/_search       |\n\nRefer to [Description](description.md) to visualize the retrieved document format for each request."
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 2, \"subpages\", 1]"
                },
                {
                  "title": "Architecture",
                  "description": null,
                  "content": {
                    "Main Components": [
                      "**`src/wazuh_modules/inventory_harvester/src/inventoryHarvester.cpp`**\nThe primary module file that defines the `InventoryHarvester` class and its methods. It orchestrates how incoming messages are ingested and then handed off for indexing.",
                      "**`src/wazuh_modules/inventory_harvester/src/inventoryHarvesterFacade.cpp`**\nA **Facade** class that provides a simplified interface to `InventoryHarvester`. By masking the underlying logic of:",
                      [
                        "Flatbuffer message handling",
                        "Index schema management",
                        "Bulk operations"
                      ],
                      "So the external components interact with `InventoryHarvester` through a unified, minimal interface.",
                      "**`src/wazuh_modules/inventory_harvester/src/common/`**\nA folder containing common operations used by the `InventoryHarvester` module:",
                      [
                        "**`clearAgent`**: Removes all data related to an agent (when the agent is removed from the manager) by sending a `DELETED_BY_QUERY` message to the Wazuh Indexer.",
                        "**`clearElements`**: Similar to the previous operation, this function is triggered by `DeleteAllEntries` message types mapped to `integrity_clear` events from the `FIM` and `System inventory` modules.",
                        [
                          "In the `System inventory` module, `integrity_clear` events are sent to the manager for each provider when it is disabled in the configuration file. i.e. packages, ports, hardware.",
                          "In the `FIM` module, `integrity_clear` events are sent to the manager for the `fim_file` component when no directories are being monitored. Similarly, for `Windows` systems, they are sent for the `fim_registry_key` and `fim_registry_value` components when no registries are being monitored."
                        ],
                        "**`elementDispatch`**: Dispatches incoming elements to the correct handler based on the element type.",
                        "**`indexSync`**: Synchronizes indices with the Wazuh Indexer.",
                        "**`upgradeAgentDb`**: Action that performs a re-synchronization between databases when upgrading the manager from a legacy ensuring that synchronization events are triggered.\nThe Inventory Harvester does not process information stored in databases, only delta and synchronization events."
                      ],
                      "**`src/wazuh_modules/inventory_harvester/src/fimInventory/` and `src/wazuh_modules/inventory_harvester/src/systemInventory/`**\nThese folders combine the **Factory Method** and **Chain of Responsibility** patterns:",
                      [
                        "**Factory Method**: Defines an interface for creating indexer-related objects (e.g., index writers or message handlers), while allowing subclasses to decide the specific type of object to instantiate. This ensures the creation logic is flexible and easily modifiable.",
                        "**Chain of Responsibility**: Organizes handlers (validation, indexing, error handling, etc.) in a chain. Each handler can either process a request or delegate it to the next handler, making the ingestion/indexing pipeline more maintainable and extensible."
                      ],
                      "**`src/wazuh_modules/inventory_harvester/src/wcsModel/`**\nContains schema definitions for the **Wazuh Common Schema (WCS)** models. By adhering to WCS, the InventoryHarvester ensures consistency and compatibility across Wazuh modules. The models capture essential information (system inventory, FIM data, etc.) and use a **JSON reflection mechanism** to convert internal data structures into JSON for the Wazuh Indexer."
                    ],
                    "High-Level Architecture Diagram": "```\nflowchart TD\n\nsubgraph WazuhManager[\"Wazuh Manager\"]\n  Remoted[\"Remoted\"]\n  subgraph WazuhModulesM[\"Wazuh Modules\"]\n    InventoryHarvester[\"Inventory Harvester\"]\n    IndexerConnector[\"Indexer Connector\"]\n    InventoryHarvester -- \"JSON Reflection\" --> IndexerConnector\n  end\n  Remoted -- \"Plain text JSON event\" --> Router\n  Router -- \"Flatbuffer event\" --> InventoryHarvester\nend\nIndexerConnector -- indexes JSON document --> WazuhIndexer\nsubgraph WazuhAgent[\"Wazuh Agent\"]\n  subgraph Providers[\"Data Provider\"]\n    OS[\"Operating System\"]\n    Packages[\"Packages\"]\n    Processes[\"Processes\"]\n    Hotfixes[\"Hotfixes\"]\n    Ports[\"Ports\"]\n    Hardware[\"Hardware\"]\n    Network[\"Networks\"]\n    Users[\"Users\"]\n    Groups[\"Groups\"]\n  end\n  subgraph WazuhModulesA[\"wazuh-modulesd\"]\n    SystemInventory[\"System inventory\"]\n  end\n  subgraph Syscheckd[\"wazuh-syscheckd\"]\n    FileM[\"File monitoring\"]\n    RegistryM[\"Registry monitoring\"]\n  end\n  Syscheckd -- \"Plain text JSON event\" --> Remoted\n  SystemInventory -- \"Plain text JSON event\" --> Remoted\nend\nProviders --> SystemInventory\nWazuhIndexer[\"Wazuh Indexer\"]\nWazuhDashboard[\"Wazuh Dashboard\"]\nWazuhDashboard -- /_search/dedicated_index --> WazuhIndexer\n```"
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 2, \"subpages\", 2]"
                },
                {
                  "title": "Settings",
                  "description": null,
                  "content": {
                    "Connection to Wazuh Indexer": "As mentioned above, the Inventory Harvester module needs to connect to the Wazuh Indexer through the Indexer Connector module.\n\n['Default Indexer Connector configuration block']\n\n```\n  <indexer>\n    <enabled>yes</enabled>\n    <hosts>\n      <host>https://0.0.0.0:9200</host>\n    </hosts>\n    <ssl>\n      <certificate_authorities>\n        <ca>/etc/filebeat/certs/root-ca.pem</ca>\n      </certificate_authorities>\n      <certificate>/etc/filebeat/certs/filebeat.pem</certificate>\n      <key>/etc/filebeat/certs/filebeat-key.pem</key>\n    </ssl>\n  </indexer>\n```\n\nIt is important to verify the status of the Wazuh Indexer **GET /_cluster/health**\n\n['e.g. Response']\n\n```\n{\n  \"cluster_name\": \"wazuh-cluster\",\n  \"status\": \"green\",\n  \"timed_out\": false,\n  \"number_of_nodes\": 1,\n  \"number_of_data_nodes\": 1,\n  \"discovered_master\": true,\n  \"discovered_cluster_manager\": true,\n  \"active_primary_shards\": 15,\n  \"active_shards\": 15,\n  \"relocating_shards\": 0,\n  \"initializing_shards\": 0,\n  \"unassigned_shards\": 0,\n  \"delayed_unassigned_shards\": 0,\n  \"number_of_pending_tasks\": 0,\n  \"number_of_in_flight_fetch\": 0,\n  \"task_max_waiting_in_queue_millis\": 0,\n  \"active_shards_percent_as_number\": 100\n}\n```",
                    "Data to index": "Once again, the **Inventory Harvester** does not have the ability to choose the information that will be indexed. All events received from agents are processed and indexed. To prevent specific information from being indexed, the corresponding feature must be disabled on the agent side, just as it works with database information.\n\n['Disabling specific Inventory providers']\n\nTurn off specific providers individually\n\n```\n<wodle name=\"syscollector\">\n<disabled>no</disabled>\n<interval>1h</interval>\n<scan_on_start>yes</scan_on_start>\n<hardware>yes</hardware>\n<os>yes</os>\n<network>yes</network>\n<packages>yes</packages>\n<ports all=\"no\">yes</ports>\n<processes>yes</processes>\n<users>yes</users>\n<groups>yes</groups>\n\n<!-- Database synchronization settings -->\n<synchronization>\n    <max_eps>10</max_eps>\n</synchronization>\n</wodle>\n```\n\n**`<hotfixes>` provider is hidden by default**\n\n['Disabling FIM components']\n\nTo disable files monitoring the following configuration must not exist\n\n```\n<directories><FILEPATH_OF_MONITORED_FILE></directories>\n```\n\nTo disabled registries monitoring the following configuration must not exist (Only Windows)\n\n```\n<windows_registry><REGISTRYPATH_OF_MONITORED_REGISTRY></windows_registry>\n```"
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 2, \"subpages\", 3]"
                },
                {
                  "title": "Description",
                  "description": null,
                  "content": {
                    "FIM": {
                      "Files": [
                        "Windows"
                      ],
                      "Registries": [
                        "Windows"
                      ]
                    },
                    "Inventory": {
                      "System": [
                        "Windows"
                      ],
                      "Packages": [
                        "Windows"
                      ],
                      "Processes": [
                        "Windows"
                      ],
                      "Ports": [
                        "Windows"
                      ],
                      "Hardware": [
                        "Windows"
                      ],
                      "Hotfixes": [
                        "Windows"
                      ],
                      "Network Protocol": [
                        "Windows"
                      ],
                      "Network address": [
                        "Windows"
                      ],
                      "Network interfaces": [
                        "Windows"
                      ],
                      "Groups": [
                        "Linux"
                      ],
                      "Users": [
                        "Linux"
                      ]
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 2, \"subpages\", 4]"
                }
              ],
              "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 2]"
            },
            {
              "title": "Utils",
              "description": "Documentation section: utils",
              "content": {},
              "metadata": {
                "type": "directory",
                "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/modules/utils"
              },
              "subpages": [
                {
                  "title": "Flatbuffers",
                  "description": "Documentation section: flatbuffers",
                  "content": {},
                  "metadata": {
                    "type": "directory",
                    "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/modules/utils/flatbuffers"
                  },
                  "subpages": [
                    {
                      "title": "Flatbuffers",
                      "description": null,
                      "content": {
                        "Flatbuffer schemas": {
                          "Common AgentInfo table": [
                            "Common agent information for FIM Delta, Inventory Delta and Synchronization events."
                          ],
                          "FIM Delta table": [
                            "Main table in flatbuffer schema for FIM Delta events."
                          ],
                          "FIM Data table": [
                            "Data table for FIM delta events."
                          ],
                          "FIM Attributes table": [
                            "Attributes table for FIM delta events."
                          ],
                          "Inventory Delta table": [
                            "Main table in flatbuffer schema for inventory Delta events."
                          ],
                          "Inventory Provider union table": [
                            "Provider union table for inventory delta events."
                          ],
                          "Inventory providers": [
                            "Provider tables for inventory delta events."
                          ],
                          "SyncMsg table": [
                            "Main table in flatbuffer schema for synchronization events."
                          ],
                          "DataUnion table union": [
                            "DataUnion table union for synchronization events."
                          ],
                          "State table": [
                            "State event type for synchronization events."
                          ],
                          "AttributesUnion table union": [
                            "Different event component types for synchronization events."
                          ],
                          "fim_file table": [
                            "fim_file table for file monitoring in synchronization events."
                          ],
                          "fim_registry_key table": [
                            "fim_registry_key table for registry monitoring in synchronization events."
                          ],
                          "fim_registry_value": [
                            "fim_registry_value table for registry monitoring in synchronization events."
                          ]
                        }
                      },
                      "metadata": {},
                      "subpages": [],
                      "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 3, \"subpages\", 0, \"subpages\", 0]"
                    }
                  ],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 3, \"subpages\", 0]"
                }
              ],
              "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 3]"
            },
            {
              "title": "Vulnerability Scanner",
              "description": "Documentation section: vulnerability-scanner",
              "content": {},
              "metadata": {
                "type": "directory",
                "path": "/home/anhnh/CodeWiki-Benchmarking-System/data/wazuh/original/docs/ref/modules/vulnerability-scanner"
              },
              "subpages": [
                {
                  "title": "Readme",
                  "description": null,
                  "content": {
                    "Introduction": "The vulnerability scanner is an event-driven module that processes operating system, hotfix and package Syscollector events looking for vulnerabilities relying on [CTI](https://cti.wazuh.com/vulnerabilities/cves) data for detection. \n\nThe CVE information provided by CTI is the result of a processing pipeline that analyzes, parses and formats the information from multiple sources in a common JSON CVE5 schema.\n\nThe vulnerability scanner reads and processes the data creating local RocksDB databases with the CVE information that later will be correlated with the incoming events. \n\nThe vulnerabilities detected are represented in a JSON document format ready to be indexed."
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 0]"
                },
                {
                  "title": "Indexed vulnerabilities ",
                  "description": null,
                  "content": {
                    "Ubuntu ": "```\n{\n  \"_index\": \"wazuh-states-vulnerabilities-jammy\",\n  \"_id\": \"001_9ad9d4c11defa663706b9812ffdf99572e969058_CVE-2016-2781\",\n  \"_score\": 1,\n  \"_source\": {\n    \"agent\": {\n      \"id\": \"001\",\n      \"name\": \"1495da319fdc\",\n      \"type\": \"Wazuh\",\n      \"version\": \"v4.11.2\"\n    },\n    \"host\": {\n      \"os\": {\n        \"full\": \"Ubuntu 22.04.5 LTS (Jammy Jellyfish)\",\n        \"kernel\": \"5.15.0-138-generic\",\n        \"name\": \"Ubuntu\",\n        \"platform\": \"ubuntu\",\n        \"type\": \"ubuntu\",\n        \"version\": \"22.04.5\"\n      }\n    },\n    \"package\": {\n      \"architecture\": \"amd64\",\n      \"description\": \"GNU core utilities\",\n      \"name\": \"coreutils\",\n      \"size\": 7282688,\n      \"type\": \"deb\",\n      \"version\": \"8.32-4.1ubuntu1.2\"\n    },\n    \"vulnerability\": {\n      \"category\": \"Packages\",\n      \"classification\": \"-\",\n      \"description\": \"chroot in GNU coreutils, when used with --userspec, allows local users toescape to the parent session via a crafted TIOCSTI ioctl call, which pushescharacters to the terminal's input buffer.\",\n      \"detected_at\": \"2025-05-05T19:04:19.577Z\",\n      \"enumeration\": \"CVE\",\n      \"id\": \"CVE-2016-2781\",\n      \"published_at\": \"2017-02-07T15:59:00Z\",\n      \"reference\": \"https://ubuntu.com/security/CVE-2016-2781, https://www.cve.org/CVERecord?id=CVE-2016-2781\",\n      \"scanner\": {\n        \"condition\": \"Package default status\",\n        \"reference\": \"https://cti.wazuh.com/vulnerabilities/cves/CVE-2016-2781\",\n        \"source\": \"Canonical Security Tracker\",\n        \"vendor\": \"Wazuh\"\n      },\n      \"score\": {\n        \"base\": 6.5,\n        \"version\": \"3.0\"\n      },\n      \"severity\": \"Medium\",\n      \"under_evaluation\": false\n    },\n    \"wazuh\": {\n      \"cluster\": {\n        \"name\": \"jammy\"\n      },\n      \"schema\": {\n        \"version\": \"1.0.0\"\n      }\n    }\n  }\n}\n```",
                    "Centos": "```\n{\n  \"_index\": \"wazuh-states-vulnerabilities-jammy\",\n  \"_id\": \"002_f660c0f64f48a92f0afe744f658e223bd5238bf1_CVE-2022-3219\",\n  \"_score\": 1,\n  \"_source\": {\n    \"agent\": {\n      \"id\": \"002\",\n      \"name\": \"5abe6b9cecda\",\n      \"type\": \"Wazuh\",\n      \"version\": \"v4.11.2\"\n    },\n    \"host\": {\n      \"os\": {\n        \"full\": \"CentOS Linux 8.4.2105\",\n        \"kernel\": \"5.15.0-138-generic\",\n        \"name\": \"CentOS Linux\",\n        \"platform\": \"centos\",\n        \"type\": \"centos\",\n        \"version\": \"8.4.2105\"\n      }\n    },\n    \"package\": {\n      \"architecture\": \"x86_64\",\n      \"description\": \"Utility for secure communication and data storage\",\n      \"installed\": \"2021-09-15T14:17:36.000Z\",\n      \"name\": \"gnupg2\",\n      \"size\": 9923131,\n      \"type\": \"rpm\",\n      \"version\": \"2.2.20-2.el8\"\n    },\n    \"vulnerability\": {\n      \"category\": \"Packages\",\n      \"classification\": \"-\",\n      \"description\": \"DOCUMENTATION: A vulnerability was found in GnuPG. GnuPG can spin on a relatively small input by crafting a public key with thousands of signatures attached and compressed down to a few kilobytes. This issue can potentially cause a denial of service.\",\n      \"detected_at\": \"2025-05-05T19:04:20.037Z\",\n      \"enumeration\": \"CVE\",\n      \"id\": \"CVE-2022-3219\",\n      \"published_at\": \"2023-02-23T20:15:12Z\",\n      \"reference\": \"https://access.redhat.com/security/cve/CVE-2022-3219\",\n      \"scanner\": {\n        \"condition\": \"Package default status\",\n        \"reference\": \"https://cti.wazuh.com/vulnerabilities/cves/CVE-2022-3219\",\n        \"source\": \"Red Hat CVE Database\",\n        \"vendor\": \"Wazuh\"\n      },\n      \"score\": {\n        \"base\": 6.2,\n        \"version\": \"3.1\"\n      },\n      \"severity\": \"Medium\",\n      \"under_evaluation\": false\n    },\n    \"wazuh\": {\n      \"cluster\": {\n        \"name\": \"jammy\"\n      },\n      \"schema\": {\n        \"version\": \"1.0.0\"\n      }\n    }\n  }\n}\n```",
                    "Windows ": "```\n{\n  \"_index\": \"wazuh-states-vulnerabilities-jammy\",\n  \"_id\": \"003_Microsoft Windows Server 2019 Datacenter Evaluation_CVE-2024-43558\",\n  \"_score\": 1,\n  \"_source\": {\n    \"agent\": {\n      \"id\": \"003\",\n      \"name\": \"vagrant\",\n      \"type\": \"Wazuh\",\n      \"version\": \"v4.11.2\"\n    },\n    \"host\": {\n      \"os\": {\n        \"full\": \"Microsoft Windows Server 2019 Datacenter Evaluation 10.0.17763.1935\",\n        \"name\": \"Microsoft Windows Server 2019 Datacenter Evaluation\",\n        \"platform\": \"windows\",\n        \"type\": \"windows\",\n        \"version\": \"10.0.17763.1935\"\n      }\n    },\n    \"package\": {\n      \"architecture\": \"x86_64\",\n      \"name\": \"Microsoft Windows Server 2019 Datacenter Evaluation 10.0.17763.1935\",\n      \"type\": \"windows\",\n      \"version\": \"10.0.17763.1935\"\n    },\n    \"vulnerability\": {\n      \"category\": \"OS\",\n      \"classification\": \"CVSS\",\n      \"description\": \"Windows Mobile Broadband Driver Denial of Service Vulnerability\",\n      \"detected_at\": \"2025-05-05T19:23:53.627Z\",\n      \"enumeration\": \"CVE\",\n      \"id\": \"CVE-2024-43558\",\n      \"published_at\": \"2024-10-08T18:15:22Z\",\n      \"reference\": \"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-43558\",\n      \"scanner\": {\n        \"condition\": \"Package less than 10.0.17763.6414\",\n        \"reference\": \"https://cti.wazuh.com/vulnerabilities/cves/CVE-2024-43558\",\n        \"source\": \"National Vulnerability Database\",\n        \"vendor\": \"Wazuh\"\n      },\n      \"score\": {\n        \"base\": 6.5,\n        \"version\": \"3.1\"\n      },\n      \"severity\": \"Medium\",\n      \"under_evaluation\": false\n    },\n    \"wazuh\": {\n      \"cluster\": {\n        \"name\": \"jammy\"\n      },\n      \"schema\": {\n        \"version\": \"1.0.0\"\n      }\n    }\n  }\n}\n```"
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 1]"
                },
                {
                  "title": "Arquitecture",
                  "description": null,
                  "content": {
                    "Main Components": [
                      "**`src/wazuh_modules/vulnerability_scanner/src/vulnerabilityScannerFacade.cpp`**\nThe main class that provides the starting point for the vulnerability scanner functionality. ",
                      [
                        "This section of the code is in charge of verifying whether or not a compressed database exists in a defined path to speed up the CVE local database availability.",
                        "Initializes `Router` communication for sync, deltas, and wazuh-db events.",
                        "Initializes the `DatabaseFeedManager` submodule and the Indexer Connector dependency module.",
                        "Creates a dispatching thread to handle incoming events, delayed events, and vulnerability reports."
                      ],
                      "**`src/wazuh_modules/vulnerability_scanner/src/scanOrchestrator/`**\nThis implementation uses the `Chain of Responsibility` design pattern to represent different stages for detection based on the event type.",
                      "We can enumerate the following cases:",
                      [
                        "ScannerType::PackageInsert: The scanner receives an event of a new detected package in the system. ",
                        "ScannerType::PackageDelete: The scanner receives an event of a package deletion. The package was uninstalled from the system and should no longer be reported as vulnerable.",
                        "ScannerType::HotfixInsert: Similar case of a package insert, but only for Windows. This specific event may solve an existent vulnerability.",
                        "ScannerType::HotfixDelete: For this case, the deletion may trigger the detection of a vulnerability.",
                        "ScannerType::Os: OS event that may trigger vulnerability detections for OS (for Windows and MacOS only).",
                        "ScannerType::IntegrityClear: Remove all existent data for specified component (OS or packages).",
                        "ScannerType::ReScanAllAgents: Triggered if the module is enabled after being disabled.",
                        "ScannerType::ReScanSingleAgent: Triggers a rescan for a single agent if the agent database is upgraded.",
                        "ScannerType::CleanupSingleAgentData: Clean action during the removal of an agent.",
                        "ScannerType::CleanupAllAgentData: Clean action to remove all agent data.",
                        "ScannerType::GlobalSyncInventory: Triggers a synchronization between the indexer local database and the information in the Wazuh Indexer."
                      ],
                      "**`src/wazuh_modules/vulnerability_scanner/src/databaseFeedManager/`**\nSubmodule in charge of process the information downloaded from CTI. Between the responsibilities of this implementation we have: ",
                      [
                        "Parse, process and create CTI information to create feed database.",
                        "Parse CVE5 formatted information.",
                        "Create CVSS, description, and other related tables to augment the vulnerability indexed information and alert reports.",
                        "Parse and process mapping details and translation information for OS and packages.",
                        "Parse and process offset information to keep the CVE database up to date."
                      ]
                    ],
                    "High-Level diagram": "```\nflowchart TD\n\nsubgraph WazuhManager[\" \"]\n  Remoted[\"Remoted\"]\n  subgraph WazuhModulesM[\" \"]\n    subgraph VulnerabilityScanner[\" \"]\n      scanContext\n    end\n    D@{ shape: braces, label: \"Vulnerability Scanner\" } --> VulnerabilityScanner\n    IndexerConnector[\"Indexer Connector\"]\n    VulnerabilityScanner -- \"JSON Reflection\" --> IndexerConnector\n  end\n  C@{ shape: braces, label: \"Wazuh Modules\" } --> WazuhModulesM\n  Remoted -- \"Plain text JSON event\" --> Router\n  Router -- \"Flatbuffer event\" --> scanContext\nend\nB@{ shape: braces, label: \"Wazuh Manager\" } --> WazuhManager\nIndexerConnector -- indexes JSON document --> WazuhIndexer\nsubgraph WazuhAgent[\"Wazuh Agent\"]\n  subgraph Providers[\"Data Provider\"]\n    OS[\"Operating System\"]\n    Packages[\"Packages\"]\n    Hotfixes[\"Hotfixes\"]\n  end\n  subgraph WazuhModulesA[\" \"]\n    Syscollector[\"Syscollector\"]\n  end\n  A@{ shape: braces, label: \"Wazuh Modules\" } --> WazuhModulesA\n  Syscollector -- \"Plain text JSON event\" --> Remoted\nend\nProviders --> Syscollector\nWazuhIndexer[\"Wazuh Indexer\"]\nWazuhDashboard[\"Wazuh Dashboard\"]\nWazuhDashboard -- /wazuh-states-vulnerabilities-*/_search --> WazuhIndexer\n```"
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 2]"
                },
                {
                  "title": "Configuration ",
                  "description": null,
                  "content": {
                    "Connection to Wazuh Indexer": "As mentioned above, the **Vulnerability Scanner** delegates the indexing to the Indexer Connector module. It receives OS and package events that will be processed against a local CVE database and hotfix information (only for Windows) to detect vulnerabilities that will be indexed through the indexer connector. \n\n['Default Indexer Connector configuration block']\n\n```\n  <indexer>\n    <enabled>yes</enabled>\n    <hosts>\n      <host>https://0.0.0.0:9200</host>\n    </hosts>\n    <ssl>\n      <certificate_authorities>\n        <ca>/etc/filebeat/certs/root-ca.pem</ca>\n      </certificate_authorities>\n      <certificate>/etc/filebeat/certs/filebeat.pem</certificate>\n      <key>/etc/filebeat/certs/filebeat-key.pem</key>\n    </ssl>\n  </indexer>\n```\n\nIt is important to verify the green status of the Wazuh Indexer with a request to the **GET /_cluster/health** endpoint. \n\n['e.g. Response']\n\n```\n{\n  \"cluster_name\": \"wazuh-cluster\",\n  \"status\": \"green\",\n  \"timed_out\": false,\n  \"number_of_nodes\": 1,\n  \"number_of_data_nodes\": 1,\n  \"discovered_master\": true,\n  \"discovered_cluster_manager\": true,\n  \"active_primary_shards\": 15,\n  \"active_shards\": 15,\n  \"relocating_shards\": 0,\n  \"initializing_shards\": 0,\n  \"unassigned_shards\": 0,\n  \"delayed_unassigned_shards\": 0,\n  \"number_of_pending_tasks\": 0,\n  \"number_of_in_flight_fetch\": 0,\n  \"task_max_waiting_in_queue_millis\": 0,\n  \"active_shards_percent_as_number\": 100\n}\n```\n\n**Currently, the module does not allow insecure connections, so it is important to verify carefully the indexer connector configuration**\n\nThe connection can be easily tested using the CURL command line with the right arguments. It is relevant to mention once again that the module does not support insecure connections, so using the **-k** option won't help to properly configure the **Indexer Connector** component. \n\n```\ncurl --cacert <root_CA_path> --cert <cert_path> --key <key_path> https://<indexer-ip>:9200/_cluster/health\n```"
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 3]"
                },
                {
                  "title": "Events format ",
                  "description": null,
                  "content": {
                    "Syscollector event types": "The vulnerability scanner as an event-driven module, reacts to the Syscollector events sent by the agents. There are two types of events received by the scanner: synchronization and delta events. \n\n['Synchronization events are sent during the first scan of the Syscollector scan or if a delta event fails. ', 'Delta events are the ones sent from the second Syscollector scan. ']\n\nThese event types provide the same information to the scanner, the detection is not affected by the type of event sent, they are just parsed differently.\n\nWithin synchronization events, an **integrity_clear** event will remove the information for a certain provider. For the case of a package provider, it will remove all vulnerabilities related to packages, for OS will remove vulnerabilities related to OS, but also affect the detection for packages, since the source operating system is a required information for detection.\nIn the case of hotfixes it should detect vulnerabilities fixed by the presence of those security patches.  ",
                    "Hotfix events (Only Windows)": {
                      "Delta event": "```\n{\n    \"agent_info\": {\n        \"agent_id\": \"002\"\n    },\n    \"data_type\": \"dbsync_hotfixes\",\n    \"data\": {\n        \"checksum\": \"1691178971959743855\",\n        \"hotfix\": \"KB5034763\",\n        \"scan_time\": \"2023/08/04 19:56:11\"\n    },\n    \"operation\": \"INSERTED\"\n}\n```",
                      "Synchronization event": "```\n{\n    \"agent_info\": {\n        \"agent_id\": \"002\"\n    },\n    \"data_type\": \"state\",\n    \"data\": {\n        \"attributes_type\": \"syscollector_hotfixes\",\n        \"attributes\": {\n            \"checksum\": \"1691178971959743855\",\n            \"hotfix\": \"KB3114960\",\n            \"scan_time\": \"2023/08/04 19:56:11\"\n        }\n    }\n}\n```\n\n['Integrity clear event']\n\n```\n{\n    \"agent_info\": {\n        \"agent_id\": \"002\"\n    },\n    \"data_type\": \"integrity_clear\",\n    \"data\": {\n        \"id\": 1700236640,\n        \"attributes_type\": \"syscollector_hotfixes\"\n    }\n}\n```"
                    },
                    "Os events ": {
                      "Delta events ": [
                        "Debian "
                      ],
                      "Synchronization events": [
                        "Windows "
                      ]
                    },
                    "Package events ": {
                      "Delta events ": [
                        "RPM package, vendor Amazon Linux "
                      ],
                      "Synchronization events": [
                        "Windows package"
                      ]
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 4]"
                },
                {
                  "title": "Flatbuffer schemas",
                  "description": null,
                  "content": {
                    "Flatbuffer schemas": {
                      "Common AgentInfo table": [
                        "Common agent information for FIM Delta, Inventory Delta and Synchronization events."
                      ],
                      "Inventory Delta table": [
                        "Main table in flatbuffer schema for inventory Delta events."
                      ],
                      "Inventory Provider union table": [
                        "Provider union table for inventory delta events. (Vulnerability scanner only process osinfo, packages, and hotfixes events)."
                      ],
                      "Inventory providers": [
                        "Provider tables for inventory delta events."
                      ],
                      "SyncMsg table": [
                        "Main table in flatbuffer schema for synchronization events."
                      ],
                      "DataUnion table union": [
                        "DataUnion table union for synchronization events."
                      ],
                      "State table": [
                        "State event type for synchronization events."
                      ],
                      "AttributesUnion table union": [
                        "Different event component types for synchronization events."
                      ],
                      "Integrity clear table": [
                        "Integrity clear event for synchronization events."
                      ]
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 5]"
                },
                {
                  "title": "Test tools",
                  "description": null,
                  "content": {
                    "Compilation ": "Command line test tools are intended for development purposes and they are not delivered in the Wazuh manager packages. To use them, it is required to compile the project by sources.\n\n```\ncd wazuh/src\nmake deps \nmake -j$(nproc) TARGET=server\n```",
                    "Vulnerability Scanner tool ": {
                      "Database creation ": "Command\n\n```\nsrc/build/wazuh_modules/vulnerability_scanner/testtool/scanner/vd_scanner_testtool -c config.json -d\n```\n\nConfiguration file\n\n```\n{\n  \"vulnerability-detection\": {\n    \"enabled\": \"yes\",\n    \"index-status\": \"no\",\n    \"cti-url\": \"https://cti.wazuh.com/api/v1/catalog/contexts/vd_1.0.0/consumers/vd_4.8.0\"\n  },\n  \"clusterName\": \"cluster01\",\n  \"clusterEnabled\": false\n}\n```\n\n['The **-d** flag performs a snapshot download from CTI and processes the content to create a local CVE database.', 'In a real Wazuh Manager installation, **clusterName** is the hostname for a single node deployment, or the cluster name for a cluster setup.', 'The outcome of this command is a RocksDB CVE database **queue** in the current directory. ', 'The process will take some minutes until the snapshot file is processed.']\n\n**Note:** It's possible to follow the process with the logs printed by the tool. Optionally, with the **-l* argument,* the logs can be dumped to a file. \n\n```\n...\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 180001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 181001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 182001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 183001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 184001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 185001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 186001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 187001\n...\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:254 processMessage : Processing line: 292001\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:369 operator() : Feed update process completed.\nOnly download content flag is set. Stopping the scanner...\n```\n\n**Note:** Starting the vulnerability scanner tool without the **-d** option will update the CVE database with new data not present in the snapshot.\n\n```\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:355 operator() : Initiating update feed process.\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:188 processMessage : Processing file: queue/vd_updater/tmp/contents/1906695-api_file.json\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:188 processMessage : Processing file: queue/vd_updater/tmp/contents/1907695-api_file.json\n...\nwazuh-modulesd:vulnerability-scanner:databaseFeedManager.hpp:369 operator() : Feed update process completed.\n```",
                      "Detection ": "For details about event format please refer to [Events](events.md)\n\nCommand\n\n```\nsrc/build/wazuh_modules/vulnerability_scanner/testtool/scanner/vd_scanner_testtool -c config.json -u -i os.json,package.json\n```\n\n['The command will detect vulnerabilities and fill the indexer databases. ']\n\n**Note:** It is possible to connect an instance of the Wazuh-Indexer and index the result of the vulnerability scan by adding the **Indexer Connector** configuration (more details [Configuration](configuration.md)).\n\n```\nsrc/build/wazuh_modules/vulnerability_scanner/testtool/scanner/vd_scanner_testtool -c config.json -t index-template.json -u -i os_event.json,package_event.json\n```\n\nExpanded configuration options for indexing\n\n```\n{\n  \"vulnerability-detection\": {\n    \"enabled\": \"yes\",\n    \"index-status\": \"yes\",\n    \"cti-url\": \"https://cti.wazuh.com/api/v1/catalog/contexts/vd_1.0.0/consumers/vd_4.8.0\"\n  },\n  \"indexer\": {\n    \"enabled\": \"yes\",\n    \"hosts\": [\n      \"https://0.0.0.0:9200\"\n    ],\n    \"username\": \"admin\",\n    \"password\": \"admin\",\n    \"ssl\": {\n      \"certificate_authorities\": [\n        \"/PATH/root-ca.pem\"\n      ],\n      \"certificate\": \"/PATH/node-1.pem\",\n      \"key\": \"/PATH/node-1-key.pem\"\n    },\n    \"update_mappings_path\": \"\"\n  },\n  \"clusterName\": \"cluster01\",\n  \"clusterEnabled\": false\n}\n```\n\n**Note:** It is important to modify accordingly the following fields:\n\n['hosts', 'certificate ', 'key ', 'certificate_authorities ', 'username', 'password']\n\nAlso, a template is required to create the mapping in the Wazuh Indexer.\n\n<details><summary>Expand</summary>\n\n```\n{\n  \"index_patterns\": [\n    \"wazuh-states-vulnerabilities-*\"\n  ],\n  \"priority\": 1,\n  \"template\": {\n    \"settings\": {\n      \"index\": {\n        \"codec\": \"best_compression\",\n        \"mapping\": {\n          \"total_fields\": {\n            \"limit\": 1000\n          }\n        },\n        \"number_of_replicas\": \"0\",\n        \"number_of_shards\": \"1\",\n        \"query.default_field\": [\n          \"agent.id\",\n          \"host.os.family\",\n          \"host.os.full\",\n          \"host.os.version\",\n          \"package.name\",\n          \"package.version\",\n          \"vulnerability.id\",\n          \"vulnerability.description\",\n          \"vulnerability.severity\",\n          \"wazuh.cluster.name\"\n        ],\n        \"refresh_interval\": \"2s\"\n      }\n    },\n    \"mappings\": {\n      \"date_detection\": false,\n      \"dynamic\": \"strict\",\n      \"properties\": {\n        \"agent\": {\n          \"properties\": {\n            \"build\": {\n              \"properties\": {\n                \"original\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                }\n              }\n            },\n            \"ephemeral_id\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"id\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"name\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"type\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"version\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"host\": {\n          \"properties\": {\n            \"os\": {\n              \"properties\": {\n                \"full\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"kernel\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"name\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"platform\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"type\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"version\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                }\n              }\n            }\n          }\n        },\n        \"package\": {\n          \"properties\": {\n            \"architecture\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"build_version\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"checksum\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"description\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"install_scope\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"installed\": {\n              \"type\": \"date\"\n            },\n            \"license\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"name\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"path\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"reference\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"size\": {\n              \"type\": \"long\"\n            },\n            \"type\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"version\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"vulnerability\": {\n          \"properties\": {\n            \"category\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"classification\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"description\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"detected_at\": {\n              \"type\": \"date\"\n            },\n            \"enumeration\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"id\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"published_at\": {\n              \"type\": \"date\"\n            },\n            \"reference\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"report_id\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"scanner\": {\n              \"properties\": {\n                \"vendor\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"source\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                }\n              }\n            },\n            \"score\": {\n              \"properties\": {\n                \"base\": {\n                  \"type\": \"float\"\n                },\n                \"environmental\": {\n                  \"type\": \"float\"\n                },\n                \"temporal\": {\n                  \"type\": \"float\"\n                },\n                \"version\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                }\n              }\n            },\n            \"severity\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"under_evaluation\": {\n              \"type\": \"boolean\"\n            }\n          }\n        },\n        \"wazuh\": {\n          \"properties\": {\n            \"cluster\": {\n              \"properties\": {\n                \"name\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"node\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                }\n              }\n            },\n            \"schema\": {\n              \"properties\": {\n                \"version\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\n</details>\n\nAdditional logs will be printed related to the vulnerabilities indexed.\n\n```\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28835.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28834.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-12243.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28835.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28834.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-12243.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28835.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28834.\nindexer-connector:indexerConnector.cpp:606 operator() : Added document for insertion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-12243.\n```\n\n**Note**: To request the information please refer to the [Opensearch API](api-reference.md)\n\n**Note**: The **-u** option disables the **Content Updater** module, so it won't process any snapshots or offsets, and it will directly process incoming events looking for vulnerabilities.\n\n**Note**: A package event needs an OS event; if we send a package event without the OS event, the tool may hang even if we later use the right command with the OS event. To overcome this, remove the **queue/vd/event** or use the **-b** option explained below.",
                      "Mocking Wazuh-DB information": "As previously mentioned, the scanner requires OS and hotfixes information for detection. That could be mocked using the options **-h** for hotfixes and **-b** for OS. \n\nExample mocked hotfix data\n\n```\n{\n  \"001\": [\n      { \"hotfix\":\"KB2468871\" },\n      { \"hotfix\":\"KB2478063\" },\n      { \"hotfix\":\"KB2533523\" },\n      { \"hotfix\":\"KB2544514\" },\n      { \"hotfix\":\"KB2600211\" },\n      { \"hotfix\":\"KB2600217\" },\n      { \"hotfix\":\"KB4502496\" },\n      { \"hotfix\":\"KB4512577\" },\n      { \"hotfix\":\"KB4512578\" },\n      { \"hotfix\":\"KB4514366\" },\n      { \"hotfix\":\"KB4535680\" },\n      { \"hotfix\":\"KB4535684\" },\n      { \"hotfix\":\"KB4535685\" },\n      { \"hotfix\":\"KB4577586\" },\n      { \"hotfix\":\"KB4580325\" },\n      { \"hotfix\":\"KB4589208\" },\n      { \"hotfix\":\"KB4601558\" },\n      { \"hotfix\":\"KB5003171\" },\n      { \"hotfix\":\"KB5003243\" },\n      { \"hotfix\":\"KB5034619\" },\n      { \"hotfix\":\"KB5034768\" },\n      { \"hotfix\":\"KB5034863\" },\n      { \"hotfix\":\"KB5012649\"}\n  ]\n}\n```\n\nExample mocked OS data for Ubuntu\n\n```\n{\n    \"001\": {\n        \"architecture\": \"x86_64\",\n        \"checksum\": \"1704514361693635656\",\n        \"hostname\": \"ubuntu-jammy\",\n        \"os_codename\": \"jammy\",\n        \"os_major\": \"22\",\n        \"os_minor\": \"04\",\n        \"os_name\": \"Ubuntu\",\n        \"os_patch\": \"3\",\n        \"os_platform\": \"ubuntu\",\n        \"os_version\": \"22.04.3 LTS (Jammy Jellyfish)\",\n        \"reference\": \"f22553c945b045bfc0d162cb890344d2f4fa8609\",\n        \"release\": \"5.15.0-91-generic\",\n        \"scan_id\": 0,\n        \"scan_time\": \"2024/01/06 04:12:44\",\n        \"sysname\": \"Linux\",\n        \"version\": \"#101-Ubuntu SMP Tue Nov 14 13:30:08 UTC 2023\"\n    }\n}\n```\n\nUsage\n\n```\nsrc/build/wazuh_modules/vulnerability_scanner/testtool/scanner/vd_scanner_testtool -c config2.json -t index-template.json -u -i package_event.json -b os_wdb.json\n```\n\n**Note:** More details about required fields [Events](events.md)."
                    },
                    "RocksDB tool ": {
                      "Inspect databases ": {
                        "Indexer databases ": "Commands\n\n```\nrocksDBQuery/rocks_db_query_testtool -d queue/indexer/db/wazuh-states-vulnerabilities-<hostname>\nrocksDBQuery/rocks_db_query_testtool -d queue/indexer/wazuh-states-vulnerabilities-<hostname>\n```\n\nExample output\n\n```\n001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-12243 ==> \n{\n  \"agent\": {\n    \"id\": \"001\",\n    \"type\": \"Wazuh\",\n    \"version\": \"v4.10.1\"\n  },\n  \"host\": {\n    \"os\": {\n      \"full\": \"CentOS Stream 9\",\n      \"kernel\": \"5.14.0-391.el9.x86_64\",\n      \"name\": \"CentOS Stream\",\n      \"platform\": \"centos\",\n      \"type\": \"centos\",\n      \"version\": \"9\"\n    }\n  },\n  \"package\": {\n    \"architecture\": \"x86_64\",\n    \"name\": \"gnutls\",\n    \"size\": 0,\n    \"type\": \"rpm\",\n    \"version\": \"3.8.2-1.el9\"\n  },\n  \"vulnerability\": {\n    \"category\": \"Packages\",\n    \"classification\": \"-\",\n    \"description\": \"DOCUMENTATION: A flaw was found in GnuTLS, which relies on libtasn1 for ASN.1 data processing. Due to an inefficient algorithm in libtasn1, decoding certain DER-encoded certificate data can take excessive time, leading to increased resource consumption. This flaw allows a remote attacker to send a specially crafted certificate, causing GnuTLS to become unresponsive or slow, resulting in a denial-of-service condition.\",\n    \"detected_at\": \"2025-04-25T18:49:27.929Z\",\n    \"enumeration\": \"CVE\",\n    \"id\": \"CVE-2024-12243\",\n    \"published_at\": \"2025-02-10T16:15:37Z\",\n    \"reference\": \"https://access.redhat.com/security/cve/CVE-2024-12243\",\n    \"scanner\": {\n      \"source\": \"Red Hat CVE Database\",\n      \"vendor\": \"Wazuh\"\n    },\n    \"score\": {\n      \"base\": 5.3,\n      \"version\": \"3.1\"\n    },\n    \"severity\": \"Medium\",\n    \"under_evaluation\": false\n  },\n  \"wazuh\": {\n    \"cluster\": {\n      \"name\": \"cluster01\"\n    },\n    \"schema\": {\n      \"version\": \"1.0.0\"\n    }\n  }\n}\n```",
                        "Inventory database": "Command \n\n```\nrocksDBQuery/rocks_db_query_testtool -d queue/inventory\n```\n\nExample output\n\n```\n001_f21aca719022f009d80bbf9224741d79029b31f2 ==> CVE-2024-28835,CVE-2024-28834,CVE-2024-12243\n```"
                      },
                      "Remove indexed vulnerability and clean databases": {
                        "Output examples ": "Clean all agents\n\n```\nwazuh-modulesd:vulnerability-scanner:scanOrchestrator.hpp:319 run : Clean-up all data event received. Cleaning up data for all agents\nwazuh-modulesd:vulnerability-scanner:resultIndexer.hpp:60 handleRequest : Processing and publish key: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28835\nwazuh-modulesd:vulnerability-scanner:resultIndexer.hpp:60 handleRequest : Processing and publish key: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28834\nwazuh-modulesd:vulnerability-scanner:resultIndexer.hpp:60 handleRequest : Processing and publish key: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-12243\nwazuh-modulesd:vulnerability-scanner:cleanInventory.hpp:89 operator() : Deleting all entries for key prefix: 001_f21aca719022f009d80bbf9224741d79029b31f2\nwazuh-modulesd:vulnerability-scanner:scanOrchestrator.hpp:339 run : Event type: 9 processed\nindexer-connector:indexerConnector.cpp:584 operator() : Added document for deletion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28835.\nindexer-connector:indexerConnector.cpp:584 operator() : Added document for deletion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-28834.\nindexer-connector:indexerConnector.cpp:584 operator() : Added document for deletion with id: 001_f21aca719022f009d80bbf9224741d79029b31f2_CVE-2024-12243.\n```\n\nClean single agent\n\n```\nwazuh-modulesd:vulnerability-scanner:scanOrchestrator.hpp:324 run : Processing 'CleanupSingleAgentData' event for agent '001'\nwazuh-modulesd:vulnerability-scanner:cleanAgentInventory.hpp:81 operator() : Deleting package agent vulnerabilities key: 001_f21aca719022f009d80bbf9224741d79029b31f2\nwazuh-modulesd:vulnerability-scanner:resultIndexer.hpp:60 handleRequest : Processing and publish key: DeleteByQuery request\n```"
                      }
                    },
                    "`databaseFeedManager` Tool": {
                      "Inject CVEs into the Vulnerability Scanner Database": {
                        "Output example": "```\nError deleting directory ./queue/vd #Ignore this\nReplacing information for CVE: CVE-1999-0103\nProcess complete for CVE: CVE-1999-0103\nReplacing information for CVE: CVE-2023-36617\nProcess complete for CVE: CVE-2023-36617\nPress enter to stop the tool...\n```"
                      }
                    }
                  },
                  "metadata": {},
                  "subpages": [],
                  "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4, \"subpages\", 6]"
                }
              ],
              "path": "[\"subpages\", 2, \"subpages\", 12, \"subpages\", 4]"
            }
          ],
          "path": "[\"subpages\", 2, \"subpages\", 12]"
        }
      ],
      "path": "[\"subpages\", 2]"
    }
  ]
}